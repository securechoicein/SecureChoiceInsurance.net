<!DOCTYPE html>
<html lang="en" id="docHtml">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Colorado Relief Options — Home &amp; Auto Insurance</title>
  <meta name="description" content="Colorado residents: explore flexible home &amp; auto insurance options designed to protect your budget and peace of mind. Bundle, save, and see if you qualify for custom rate relief or flexible payments." />

  <!-- ================= QUICK SETUP =================
  REQUIRED FILES IN SAME FOLDER:
  - index.html
  - hero-house.png
  - hero-auto.png
  - hero-business.png
  ================================================== -->

  <script>
    // === REQUIRED: paste your deployed Google Apps Script Web App URL here ===
    window.GAS_WEBAPP_URL = "https://script.google.com/macros/s/AKfycbw5WUyuqjP6HODx88cSVY2ga2jhl7g29fRaqJb7OXneFH96lM0TyEGZxZdQtnD0dbOf4A/exec";

    // Optional separate LLM endpoint (usually leave blank to reuse GAS)
    window.POLICYPRO_LLM_ENDPOINT = "";

    // ✅ Default: run PolicyPro in LOCAL mode (no API keys required)
    window.POLICYPRO_MODE = "local"; // "local" or "remote"

    // Tracking (optional)
    window.GA4_MEASUREMENT_ID = "";
    window.GOOGLE_ADS_ID = "";
    window.GOOGLE_ADS_CONVERSION_LABEL = "";
    window.META_PIXEL_ID = "";

    window.AGENT_EMAIL = "securechoicein@gmail.com";

    // === ClickFunnels (recommended for "Check My Options") ===
    window.CLICKFUNNEL_URL = "";

    // ===== Conditional reveal: Check My Options appears after interaction =====
    // NOTE: must run AFTER DOM exists (mobile was not wiring the button)
    window.addEventListener('DOMContentLoaded', function(){
      var cta = document.getElementById('openFunnel');
      var hcBtn = document.getElementById('openHealthCheck');
      if(!cta) return;

      function revealCTA(){
        cta.classList.add('visible');
        cta.removeAttribute('aria-hidden');
        cta.style.opacity = '1';
        cta.style.pointerEvents = 'auto';
        cta.style.transform = 'translateY(0)';
        window.removeEventListener('scroll', onScroll);
      }

      function onScroll(){
        if(window.scrollY > window.innerHeight * 0.15){
          revealCTA();
        }
      }

      // On mobile, show it immediately (no dead CTA)
      if(window.matchMedia && window.matchMedia('(max-width: 900px)').matches){
        revealCTA();
      } else {
        window.addEventListener('scroll', onScroll, { passive:true });
      }

      if(hcBtn){
        hcBtn.addEventListener('click', revealCTA);
        hcBtn.addEventListener('touchend', function(){
          revealCTA();
        }, { passive:true });
      }
    });
  </script>

  <!-- Preload hero images for smoother first paint (PNG only) -->
  <link rel="preload" as="image" href="hero-house.png">
  <link rel="preload" as="image" href="hero-auto.png">
  <link rel="preload" as="image" href="hero-business.png">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Playfair+Display:wght@500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --card:#0f172a;
      --line:rgba(148,196,255,.35);
      --brand:#38bdf8;
      --brand2:#0ea5e9;
      --ok:#22c55e;
      --warn:#facc15;

      /* Desktop hero fitting:
        - "contain" shows the full PNG (no cropping)
        - "cover" fills the hero (may crop)
      */
      --hero-fit-desktop: cover;
      --hero-bg-desktop: #000;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter,system-ui,sans-serif;
      background:#0b1323;
      color:#e5e7eb;
      overflow-x:hidden;
    }

    /* HERO */
    .hero{
      position:relative;
      min-height:90vh;
      display:flex;
      align-items:center;
      justify-content:flex-start;
      padding:48px;
      overflow:hidden;
      isolation:isolate;
    }

    /* Make hero content readable + consistent across screen sizes */
    .hero-content{position:relative;max-width:680px;z-index:2;width:100%;}

    /* Dark overlay so text stays readable on photos */
    .hero::before{
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(rgba(5,10,25,.55), rgba(5,10,25,.55));
      z-index:1;
      pointer-events:none;
    }

    /* Rotating background slides (mobile-safe): JS-driven crossfade */
    .hero-rotator{
      position:absolute;
      inset:0;
      height:100%;
      z-index:0;
      pointer-events:none;
      background:transparent;
    }

    .hero-slide{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      object-fit:cover;
      object-position:50% 50%;
      opacity:0;
      filter: brightness(1.08) contrast(1.12) saturate(1.12);
      image-rendering:auto;
      transition:opacity 900ms ease;
      will-change:opacity;
    }
    .hero-slide.active{ opacity:1; }

    /* Desktop hero fitting */
    @media (min-width: 901px){
      .hero{ min-height:100vh; padding:72px 72px; }
      .hero-content{ max-width:760px; }
      .hero-rotator{ background: var(--hero-bg-desktop); }
      .hero-slide{
        object-fit: var(--hero-fit-desktop);
        object-position: 50% 45%;
        transform:none;
        filter: brightness(1.12) contrast(1.15) saturate(1.15);
      }
    }

    /* Reduce motion for accessibility */
    @media (prefers-reduced-motion: reduce){
      .hero-slide{ transition:none; }
    }

    .badge{display:inline-block;padding:6px 12px;border-radius:999px;background:rgba(56,189,248,.15);border:1px solid rgba(56,189,248,.4);font-size:12px;font-weight:700;color:#c7e9ff}

    /* Hero header (uses the same font as the PP mark) */
    .hero-headline{
      margin:0 0 18px;
      font-size:clamp(40px,6vw,72px);
      line-height:1.02;
      letter-spacing:.01em;
      color:#ffffff;
      font-family:'Playfair Display','Didot','Bodoni MT',serif;
      font-weight:700;
      text-shadow:0 18px 70px rgba(0,0,0,.55);
    }

    /* Primary CTA – ChannelTalk-style (white, PP font) */
    .hero-cta-wrap{display:flex;flex-direction:column;gap:10px;max-width:520px;}
    .cta{
      margin-top:24px;
      padding:14px 28px;
      font-size: 16px;
      line-height: 1.6;
      opacity: 0;
      transform: translateY(6px);
      animation: phcFadeIn 0.6s ease-out forwards;
      animation-delay: 0.4s;
      font-weight:700;
      border-radius:999px;
      border:1px solid #e5e7eb;
      cursor:pointer;
      background:#ffffff;
      color:#0b1120;
      font-family:'Playfair Display','Didot','Bodoni MT',serif;
      box-shadow:0 18px 55px rgba(0,0,0,.25);
      transition:transform .15s ease, box-shadow .15s ease, filter .15s ease;
    }
    .cta:hover{ transform:translateY(-1px); box-shadow:0 22px 70px rgba(0,0,0,.28); filter:brightness(1.01); }
    .cta:active{transform:translateY(0);box-shadow:0 14px 40px rgba(0,0,0,.22);}

    /* Secondary CTA (Health Check) */
    .cta.cta-secondary{ margin-top:0; background:rgba(255,255,255,.94); position:relative; }
    .cta.cta-secondary::before{
      content:"";
      position:absolute;
      inset:-1px;
      border-radius:999px;
      background:linear-gradient(90deg, rgba(56,189,248,.75), rgba(34,197,94,.55), rgba(56,189,248,.75));
      z-index:-1;
      opacity:.85;
    }
    .cta.cta-secondary:hover{ filter:brightness(1.03); }

    /* Policy Health Check hook — match Channelview / ChannelTalk font */
    .phc-hook-hero{
      margin:0 0 10px;
      font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      font-size:16px;
      font-weight:600;
      line-height:1.5;
      letter-spacing:-0.01em;
      color:#ffffff;
      text-shadow:0 12px 36px rgba(0,0,0,.45);
      opacity:.98;
      padding:12px 14px;
      border-radius:16px;
      background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
      border:1px solid rgba(148,196,255,.35);
      box-shadow:0 18px 60px rgba(0,0,0,.26);
      position:relative;
      overflow:hidden;
    }
    .phc-hook-hero::before{
      content:"";
      position:absolute;
      inset:0;
      pointer-events:none;
      background:radial-gradient(600px 180px at 18% 0%, rgba(56,189,248,.28), transparent 55%),
                 radial-gradient(420px 180px at 92% 10%, rgba(34,197,94,.14), transparent 60%);
      opacity:.95;
    }
    .phc-hook-hero.attn{ animation:phcGlow 2.4s ease-in-out 1; }
    @keyframes phcGlow{
      0%{opacity:.9;}
      40%{opacity:1; text-shadow:0 0 0 rgba(56,189,248,0);}
      70%{text-shadow:0 0 28px rgba(56,189,248,.45);}
      100%{opacity:.98;}
    }

    /* Optional: gently guide users to start with the Health Check once per visitor */
    body.phc-gate #openFunnel{ opacity:.82; filter:saturate(.92) brightness(.98); transform:translateY(0); }
    body.phc-gate #ctaMicro{ opacity:.92; }
    body.phc-gate #openHealthCheck{ box-shadow:0 22px 80px rgba(56,189,248,.10), 0 18px 55px rgba(0,0,0,.25); }

    /* Microcopy under CTA */
    .cta-micro{ font-size:12px; font-weight:800; color:rgba(226,232,240,.92); text-shadow:0 10px 30px rgba(0,0,0,.45); letter-spacing:.01em; }

    /* Mobile: make the primary CTA easier to tap */
    @media (max-width: 900px){
      .hero{padding:18px;min-height:100vh;align-items:flex-start;padding-top:72px;}
      .hero-headline{font-size:clamp(34px,9vw,52px);}
      .hero-content{max-width:100%;padding-bottom:90px;}
      .hero-cta-wrap{max-width:520px;width:100%;}
      .cta{
        width:100%;
        max-width:520px;
        margin-top:10px;
        margin-bottom:0;
        padding:14px 18px;
        font-size:15px;
        min-height:50px;
      }
      .cta-micro{font-size:12px;opacity:.95;}
    }

    /* Alert */
    .alert-box{position:absolute;right:8%;bottom:12%;width:260px;background:rgba(15,23,42,.92);border-radius:14px;padding:14px;border:1px solid rgba(148,196,255,.55);box-shadow:0 20px 50px rgba(0,0,0,.6);z-index:2}
    .alert-title{font-size:11px;text-transform:uppercase;letter-spacing:.14em;color:#facc15;margin-bottom:6px}
    .alert-text{font-size:13px;color:#e5e7eb;line-height:1.35}
    @media (max-width: 1100px){ .alert-box{display:none;} }

    /* ================== POLICY HEALTH CHECK ================== */
    @media (min-width: 1024px){
      .phc-container{max-width: 720px;margin-left: auto;margin-right: auto;}
      .phc-card{padding: 16px 18px;}
      .phc-question{margin-bottom: 12px;}
      .phc-answers{display: grid;grid-template-columns: repeat(2, 1fr);gap: 10px;}
    }
    .phc-result{max-width:100%;}
    .phc-wrap{max-width:960px;margin:32px auto 18px;padding:0 16px;}
    .phc-card{
      background:#ffffff;
      border-radius:20px;
      border:1px solid #e5e7eb;
      box-shadow:0 20px 60px rgba(2,6,23,.12);
      padding:22px 22px 18px;
    }
    .phc-header{display:flex;gap:14px;align-items:flex-start;margin-bottom:16px;}
    .phc-badge{flex:0 0 auto;width:36px;height:36px;border-radius:10px;display:flex;align-items:center;justify-content:center;background:#0ea5e9;color:#fff;font-weight:900;}
    .phc-title{font-size:18px;font-weight:900;color:#0b1120;margin:0;}
    .phc-hook{margin:6px 0 0;font-size:13px;line-height:1.4;color:#475569;font-weight:700;}

    /* ================== PHC RESULT (Green/Yellow/Red) ================== */
    .phc-result{
      display:none;
      margin-top:14px;
      border:1px solid #e5e7eb;
      border-radius:18px;
      padding:14px 14px 12px;
      background:#ffffff;
      box-shadow:0 14px 40px rgba(2,6,23,.06);
    }
    .phc-result.show{display:block;}
    .phc-result-top{display:flex;align-items:center;justify-content:space-between;gap:12px;}
    .phc-result-left{display:flex;align-items:center;gap:10px;}
    .phc-dot{width:12px;height:12px;border-radius:999px;background:#22c55e;box-shadow:0 0 0 6px rgba(34,197,94,.12);} /* green */
    .phc-dot.yellow{background:#facc15;box-shadow:0 0 0 6px rgba(250,204,21,.16);} /* yellow */
    .phc-dot.red{background:#ef4444;box-shadow:0 0 0 6px rgba(239,68,68,.14);} /* red */
    .phc-result-label{font-weight:1000;color:#0b1120;font-size:12px;letter-spacing:.08em;text-transform:uppercase;}
    .phc-result-copy{margin:10px 0 8px;color:#0b1120;font-weight:900;font-size:13px;line-height:1.35;}

    /* Subhead animation (shown after PHC completes) */
    .phc-subhead{
      margin:10px 0 6px;
      color:#0b1120;
      font-weight:700;
      font-size:13px;
      line-height:1.45;
      opacity:0;
      transform:translateY(6px);
      animation:phcSubheadIn .55s ease-out forwards;
      animation-delay:.15s;
    }
    .phc-subhead.green{animation-delay:.1s;}
    .phc-subhead.red{animation-delay:.28s;}
    @keyframes phcSubheadIn{to{opacity:1;transform:translateY(0);}}
    .phc-result-why{margin:0;padding-left:18px;display:grid;gap:6px;}

    /* Loyalty callout (shown on Red results) */
    .phc-loyalty{display:none;margin-top:12px;padding:12px;border-radius:16px;border:1px solid rgba(15,23,42,.12);background:linear-gradient(180deg, #ffffff, #f8fafc);box-shadow:0 12px 26px rgba(2,6,23,.06);}
    .phc-loyalty.show{display:block;}
    .phc-loyalty .m{font-weight:1000;color:#0b1120;font-size:13px;line-height:1.3;margin:0 0 10px;}
    .phc-loyalty .btn{width:100%;}
    .phc-result-actions{margin-top:12px;display:flex;gap:10px;align-items:center;justify-content:flex-end;flex-wrap:wrap;}
    .phc-run{border:1px solid #cbd5e1;background:#fff;color:#0b1120;font-weight:1000;}
    .phc-continue{border:1px solid #0b1120;background:#0b1120;color:#fff;font-weight:1000;}
    @media (max-width: 600px){
      .phc-result{border-radius:16px;}
      .phc-result-actions .btn{width:100%;}
    }

    /* ================== POLICY HEALTH CHECK CHIPS ================== */
    .phc-grid{display:flex;flex-wrap:wrap;gap:10px;margin-top:10px;}
    .phc-chip{display:inline-flex;align-items:center;gap:10px;padding:12px 14px;border-radius:16px;border:1px solid #e2e8f0;background:#f8fafc;color:#0b1120;font-weight:900;font-size:12.5px;cursor:pointer;box-shadow:0 12px 26px rgba(2,6,23,.06);}
    .phc-chip input{transform:scale(1.05);}
    .phc-chip.active{border-color:#0ea5e9 !important;background:rgba(14,165,233,.10) !important;}
    @media (max-width: 420px){.phc-chip{width:100%;justify-content:flex-start;}}

    /* ================== PHC MOBILE TAP FLOW ================== */
    .phc-mobile-flow{display:none;}
    .phc-q{border:1px solid #e5e7eb;border-radius:16px;padding:12px 12px 10px;background:#f8fafc;}
    .phc-q-title{margin:0 0 8px;font-weight:1000;color:#0b1120;font-size:13px;line-height:1.25;}
    .phc-q-hint{margin:0 0 10px;color:#64748b;font-weight:800;font-size:11.5px;line-height:1.35;}
    .phc-answers{display:grid;gap:10px;}
    .phc-answer-btn{
      width:100%;
      text-align:left;
      border:1px solid #cbd5e1;
      background:#ffffff;
      border-radius:14px;
      padding:12px;
      font-weight:1000;
      color:#0b1120;
      cursor:pointer;
      box-shadow:0 10px 22px rgba(2,6,23,.05);
      -webkit-tap-highlight-color: transparent;
    }
    .phc-answer-btn:active{transform:translateY(1px)}
    .phc-answer-btn.active{border-color:#0ea5e9;background:rgba(14,165,233,.10);box-shadow:0 12px 26px rgba(2,6,23,.07);}
    .phc-mobile-nav{display:flex;gap:10px;margin-top:12px;}

    /* Mobile: keep Back/Continue visible while scrolling inside the PHC modal */
    @media (max-width: 600px){
      .phc-q{padding-bottom:14px;}
      .phc-mobile-nav{
        position:sticky;
        bottom:0;
        padding-top:10px;
        padding-bottom:calc(10px + env(safe-area-inset-bottom));
        background:linear-gradient(180deg, rgba(248,250,252,0), rgba(248,250,252,1) 32%);
        z-index:5;
      }
    }
    .phc-mobile-nav .btn{flex:1;}

    @media (max-width: 600px){
      .phc-mobile-flow{display:block;}
      .phc-desktop-grid{display:none !important;}
      .phc-grid{gap:8px;}
      .phc-chip{width:100%;justify-content:flex-start;}
    }

    /* ================== CHAT: Channel.io-like launcher ================== */
    .chat-launcher{
      position:fixed;
      right:20px;
      bottom:22px;
      z-index:26000;
      display:flex;
      align-items:center;
      gap:10px;
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .chat-peek{
      display:flex;
      flex-direction:column;
      gap:2px;
      padding:10px 12px;
      border-radius:14px;
      background:#ffffff;
      border:1px solid #e5e7eb;
      backdrop-filter:blur(10px);
      box-shadow:0 18px 55px rgba(0,0,0,.25);
    }
    .chat-peek .chat-label{
      font-size:11px;
      opacity:.85;
      font-weight:700;
      color:#0b1120;
      letter-spacing:.01em;
      font-family:'Playfair Display','Didot','Bodoni MT',serif;
    }
    .chat-peek .chat-name{
      font-weight:700;
      font-size:13px;
      letter-spacing:.01em;
      color:#0b1120;
      font-family:'Playfair Display','Didot','Bodoni MT',serif;
    }
    .chat-bubble{
      width:56px;height:56px;
      border-radius:999px;
      display:flex;align-items:center;justify-content:center;
      background:#ffffff;
      border:1px solid #e5e7eb;
      box-shadow:0 22px 70px rgba(0,0,0,.25);
      position:relative;
      transition:transform .18s ease, filter .18s ease;
      animation: chatPulse 2.6s ease-in-out infinite;
    }
    .chat-bubble:hover{transform:translateY(-2px) scale(1.03);filter:brightness(1.06)}
    .chat-bubble:active{transform:translateY(0) scale(0.99)}
    .chat-avatar{
      width:44px;height:44px;
      border-radius:999px;
      display:flex;align-items:center;justify-content:center;
      font-family:'Playfair Display', 'Didot', 'Bodoni MT', serif;
      font-weight:600;
      font-size:22px;
      color:#020617;
      background:#ffffff;
    }
    @keyframes chatPulse{
      0%{ box-shadow:0 22px 70px rgba(0,0,0,.25), 0 0 0 0 rgba(2,6,23,.15); }
      50%{ box-shadow:0 22px 70px rgba(0,0,0,.25), 0 0 0 12px rgba(2,6,23,0); }
      100%{ box-shadow:0 22px 70px rgba(0,0,0,.25), 0 0 0 0 rgba(2,6,23,0); }
    }

    /* ================== CHAT WIDGET (ChannelTalk-like) ================== */
    .chat-window{ display:none; position:fixed; right:20px; bottom:96px; width:360px; max-height:78vh; z-index:25000; }
    .pp-widget{ width:100%; background:#fff; color:#0b1120; border-radius:22px; overflow:hidden; border:1px solid rgba(15,23,42,.10); box-shadow:0 40px 120px rgba(0,0,0,.42); }
    .pp-top{ position:relative; height:150px; background: linear-gradient(180deg, rgba(2,6,23,0) 40%, rgba(2,6,23,.45) 100%), url('hero-house.png') center/cover no-repeat; }
    .pp-topbar{ position:absolute; left:0; right:0; bottom:0; padding:14px 14px 12px; display:flex; align-items:flex-end; justify-content:space-between; gap:10px; }
    .pp-brand{color:#fff;font-weight:900;letter-spacing:.01em;font-size:18px;text-shadow:0 8px 30px rgba(0,0,0,.55);}
    .pp-body{padding:12px 14px 10px;background:#fff;}
    .pp-screen{ display:none; }
    .pp-screen.active{ display:block; }
    .pp-home-card{border:1px solid #eef2f7;border-radius:18px;padding:12px;background:#fff;box-shadow:0 14px 40px rgba(2,6,23,.06);}
    .pp-home-row{display:flex;gap:10px;align-items:flex-start}
    .pp-avatar{width:38px;height:38px;border-radius:999px;display:flex;align-items:center;justify-content:center;border:1px solid #e5e7eb;background:#fff;font-family:'Playfair Display','Didot','Bodoni MT',serif;font-weight:700;color:#0b1120;flex:0 0 auto;}
    .pp-home-title{margin:0;font-weight:900;font-size:13.5px;line-height:1.25}
    .pp-home-sub{margin:6px 0 0;color:#475569;font-weight:700;font-size:12px;line-height:1.35}
    .pp-primary{width:100%;margin-top:12px;padding:12px;border-radius:999px;border:1px solid #eef2f7;background:#f3f4f6;color:#0b1120;font-weight:900;cursor:pointer;display:flex;align-items:center;justify-content:center;gap:10px;}
    .pp-primary:hover{filter:brightness(1.01)}
    .pp-footer-note{margin-top:10px;display:flex;align-items:center;justify-content:center;gap:8px;color:#94a3b8;font-weight:800;font-size:11px;}
    .pp-messages-wrap{border:1px solid #eef2f7;border-radius:18px;overflow:hidden;background:#fff;}
    .chat-main{display:flex;flex-direction:column;height:360px;min-height:320px;}
    .chat-messages{padding:12px;overflow:auto;flex:1;background:#ffffff;}
    .msg{display:flex;margin:10px 0}
    .msg.user{justify-content:flex-end}
    .msg.bot{justify-content:flex-start}
    .bubble{max-width:86%;padding:10px 12px;border-radius:14px;font-size:13.5px;line-height:1.45;box-shadow:0 10px 26px rgba(0,0,0,.06)}
    .bubble.user{background:#0b1120;color:#e5e7eb;border-top-right-radius:6px}
    .bubble.bot{background:#ffffff;color:#0f172a;border:1px solid #e5e7eb;border-top-left-radius:6px}
    .chat-inputbar{padding:10px;border-top:1px solid #eef2f7;background:#fff;display:flex;gap:10px;align-items:center}
    .chat-input{flex:1;padding:12px 12px;border-radius:14px;border:1px solid #cbd5e1;font-size:14px;outline:none}
    .chat-input:focus{border-color:rgba(56,189,248,.9);box-shadow:0 0 0 4px rgba(56,189,248,.12)}
    .send-btn{padding:12px 14px;border-radius:14px;border:1px solid #0b1120;background:#0b1120;color:#e5e7eb;font-weight:1000;cursor:pointer}
    .send-btn:disabled{opacity:.55;cursor:not-allowed}
    .typing{display:inline-flex;gap:4px;align-items:center}
    .dot{width:6px;height:6px;border-radius:999px;background:#94a3b8;animation:bounce 1.1s infinite}
    .dot:nth-child(2){animation-delay:.15s}
    .dot:nth-child(3){animation-delay:.3s}
    @keyframes bounce{0%,80%,100%{transform:translateY(0);opacity:.5}40%{transform:translateY(-4px);opacity:1}}

    .pp-tabs{display:grid;grid-template-columns:1fr 1fr 1fr;border-top:1px solid #eef2f7;background:#fff;padding:8px 6px;}
    .pp-tab{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:6px;padding:8px 6px;border-radius:14px;border:0;background:transparent;cursor:pointer;color:#64748b;font-weight:900;font-size:11px;}
    .pp-tab svg{width:18px;height:18px;opacity:.75;transition:transform .15s ease, opacity .15s ease}
    .pp-tab#ppTabSettings svg{width:19px;height:19px;stroke-width:1.8;}
    .pp-tab#ppTabSettings:hover svg{opacity:.95;transform:rotate(20deg)}
    .pp-tab#ppTabSettings.active svg{opacity:1;transform:rotate(0deg)}
    .pp-tab.active{color:#0b1120;background:#f8fafc;}
    .pp-tab:hover{color:#0b1120;background:#f8fafc}

    .pp-close-fab{position:absolute;right:10px;bottom:-62px;width:48px;height:48px;border-radius:999px;border:1px solid #e5e7eb;background:#fff;color:#0b1120;box-shadow:0 18px 60px rgba(0,0,0,.25);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:20px;font-weight:900;}
    .pp-close-fab:hover{filter:brightness(1.02)}

    .pp-settings{border:1px solid #eef2f7;border-radius:18px;padding:12px;background:#fff;}
    .pp-settings h3{margin:0 0 10px;font-size:13.5px;font-weight:1000;color:#0b1120}
    .pp-setting-item{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px;border:1px solid #eef2f7;border-radius:14px;background:#fff;margin-bottom:10px}
    .pp-select{appearance:none;-webkit-appearance:none;-moz-appearance:none;border:1px solid #e2e8f0;background:#f8fafc;color:#0b1120;font-weight:900;font-size:12px;border-radius:12px;padding:10px 34px 10px 12px;cursor:pointer;line-height:1;box-shadow:0 10px 22px rgba(2,6,23,.05);
      background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%23647569' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      background-repeat:no-repeat;background-position:right 10px center;background-size:18px 18px;
    }
    .pp-select:focus{outline:none;border-color:rgba(56,189,248,.9);box-shadow:0 0 0 4px rgba(56,189,248,.12)}
    .pp-select:hover{filter:brightness(1.01)}
    .pp-setting-item .k{font-weight:900;color:#0b1120;font-size:12px}
    .pp-setting-item .v{font-weight:900;color:#64748b;font-size:12px}
    .pp-setting-link{display:block;text-align:center;margin-top:6px;color:#0ea5e9;font-weight:1000;text-decoration:none}

    /* Funnel modal */
    .modal-overlay{position:fixed;inset:0;background:rgba(2,6,23,.72);backdrop-filter:blur(6px);display:none;z-index:20000;}
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;padding:18px;z-index:21000;}
    .card{width:min(760px,96vw);background:#ffffff;color:#0b1323;border-radius:18px;box-shadow:0 40px 100px rgba(0,0,0,.8);overflow:hidden;border:1px solid #e5e7eb;max-height:86vh;}

    /* Desktop: keep modal usable by scrolling inside the card (not the page) */
    @media (min-width: 601px){
      .card-head{position:sticky;top:0;z-index:3;}
      .card-body{max-height:calc(86vh - 64px);overflow:auto;-webkit-overflow-scrolling:touch;}
      .row.row-desktop{position:sticky;bottom:0;left:0;right:0;background:linear-gradient(180deg, rgba(255,255,255,0), rgba(255,255,255,1) 32%);padding-top:12px;margin-top:12px;}
    }

    /* Mobile-friendly CTA modal (bottom-sheet style) */
    @media (max-width: 600px){
      .modal{align-items:flex-end;}
      .card{width:100%;max-width:100%;max-height:85vh;border-radius:18px 18px 0 0;}
      .card-head{position:sticky;top:0;z-index:2;}
      .card-body{overflow:auto;-webkit-overflow-scrolling:touch;}
      
      /* Lead Modal (#modal) fullscreen treatment like PHC */
      #modal{
        align-items:stretch !important;
        padding:0 !important;
      }
      #modal .card{
        width:100vw !important;
        height:100dvh !important;
        height:100vh !important;
        max-width:100% !important;
        max-height:none !important;
        border-radius:0 !important;
        margin:0 !important;
      }
      #modal .card-body{
        height:100%;
        overflow-y:auto;
        -webkit-overflow-scrolling:touch;
      }
      #modal .row-mobile{
        position:sticky;
        bottom:0;
        padding-bottom:calc(12px + env(safe-area-inset-bottom));
        background:linear-gradient(180deg, rgba(255,255,255,0), rgba(255,255,255,1) 28%);
        z-index:10;
      }
    }

    /* PHC Modal specific mobile adjustments */
    @media (max-width: 600px){
      #phcModal{
        align-items:flex-end;
        padding: 0 0 env(safe-area-inset-bottom);
      }
      #phcModal .card{
        width:100%;
        max-width:100%;
        max-height:90vh;
        border-radius:18px 18px 0 0;
        display:flex;
        flex-direction:column;
      }
      #phcModal .card-head{
        position:sticky;
        top:0;
        z-index:2;
        flex-shrink:0;
      }
      #phcModal .card-body{
        flex:1;
        overflow-y:auto;
        -webkit-overflow-scrolling:touch;
        min-height:0;
      }
    }

    /* Stepper (used mainly on mobile) */
    .stepper{display:none;padding:12px 2px 10px;margin:0 0 8px;}
    .stepper-top{display:flex;align-items:baseline;justify-content:space-between;gap:10px;}
    .stepper-kicker{font-size:11px;font-weight:900;color:#64748b;letter-spacing:.02em;}
    .stepper-title{font-size:12px;font-weight:1000;color:#0b1120;}
    .stepper-dots{display:flex;gap:8px;margin-top:10px;}
    .dotx{width:10px;height:10px;border-radius:999px;background:#e2e8f0;}
    .dotx.active{background:#0b1120;}
    .stepper-bar{height:6px;border-radius:999px;background:#eef2f7;margin-top:10px;overflow:hidden;}
    .stepper-bar-fill{display:block;height:100%;width:25%;background:#0b1120;transition:width .2s ease;}
    .steps{margin-top:6px;}
    .step{display:none;}
    .step.active{display:block;}

    /* Desktop keeps the original all-sections view */
    @media (min-width: 601px){
      .stepper{display:none;}
      .step{display:block;}
      .row-mobile{display:none !important;}
    }

    /* Mobile: one step at a time + sticky step controls */
    @media (max-width: 600px){
      .stepper{display:block;}
      .grid{grid-template-columns:1fr !important;}
      .row-desktop{display:none !important;}
      .row-mobile{position:sticky;bottom:0;left:0;right:0;padding:12px 0 0;background:linear-gradient(180deg, rgba(255,255,255,0), rgba(255,255,255,1) 28%);gap:10px;justify-content:space-between;}
      .row-mobile .btn{flex:1;}
      /* PHC: hide the desktop Finish/Reset row on mobile (mobile uses step flow) */
      #phcDesktopActions{display:none !important;}
    }

    .card-head{display:flex;align-items:flex-start;justify-content:space-between;gap:14px;padding:14px 16px;background:#f8fafc;border-bottom:1px solid #e5e7eb;}
    .card-head h2{margin:0;font-size:16px;font-weight:900;}
    .card-head p{margin:2px 0 0;font-size:12px;color:#475569;max-width:none;}
    .icon-btn{background:transparent;border:none;font-size:18px;cursor:pointer;color:#475569;}
    .card-body{padding:14px 16px;}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
    @media(max-width:740px){.grid{grid-template-columns:1fr;}}
    .field{display:grid;gap:6px;}
    .field label{font-size:12px;font-weight:900;color:#0f172a;}
    .field input,.field select,.field textarea{padding:12px;border-radius:12px;border:1px solid #cbd5e1;font-size:14px;}
    .field textarea{resize:vertical;min-height:90px;}
    .hint{font-size:11px;color:#64748b;font-weight:700;}
    .row{display:flex;gap:10px;flex-wrap:wrap;justify-content:flex-end;margin-top:12px;}
    .btn{padding:12px 14px;border-radius:12px;border:1px solid #cbd5e1;background:#fff;cursor:pointer;font-weight:900;}
    .btn-primary{border:1px solid #0b1120;background:#0b1120;color:#e5e7eb;}
    .status{display:none;margin-top:10px;font-size:12px;font-weight:800;}
    .status.ok{color:#166534;}
    .status.err{color:#b91c1c;}
    
    /* PDF Results Panel */
    .pdf-results-panel{display:none;margin-top:14px;padding:14px;border-radius:12px;background:#f8fafc;border:1px solid #e5e7eb;}
    .pdf-results-panel.show{display:block;}
    .pdf-results-title{font-size:14px;font-weight:900;color:#0b1120;margin:0 0 8px;}
    .pdf-results-text{font-size:12px;font-weight:700;color:#475569;margin:0 0 12px;}
    .pdf-email-gate{margin-bottom:12px;}
    .pdf-email-gate .field{margin:0;}

    /* Disclaimer button */
    .disc-btn{position:fixed;left:18px;bottom:18px;z-index:15000;background:rgba(15,23,42,.85);backdrop-filter:blur(10px);border:1px solid rgba(148,196,255,.45);color:#e5e7eb;padding:10px 14px;border-radius:999px;font-weight:900;font-size:12px;cursor:pointer;box-shadow:0 16px 50px rgba(0,0,0,.6)}
    .disc-btn:hover{filter:brightness(1.06)}

    /* Disclaimer modal */
    .disc-overlay{position:fixed;inset:0;background:rgba(2,6,23,.72);backdrop-filter:blur(6px);display:none;z-index:30000;}
    .disc-modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;padding:18px;z-index:31000;overflow:auto;}
    .disc-card{width:min(880px,96vw);max-height:86vh;background:#ffffff;color:#0b1323;border-radius:22px;box-shadow:0 50px 130px rgba(0,0,0,.85);overflow:hidden;border:1px solid rgba(148,196,255,.35);position:relative;}
    .disc-card::before{content:"";position:absolute;inset:0;pointer-events:none;background:radial-gradient(1200px 500px at 20% -10%, rgba(56,189,248,.18), transparent 55%),radial-gradient(900px 500px at 90% 10%, rgba(34,197,94,.14), transparent 55%);}
    .disc-head{position:relative;display:flex;align-items:flex-start;justify-content:space-between;gap:14px;padding:14px 16px;background:linear-gradient(180deg,#0b1120,#0f172a);border-bottom:1px solid rgba(148,196,255,.25);color:#e5e7eb;}
    .disc-head h2{margin:0;font-size:16px;font-weight:900;letter-spacing:.01em;}
    .disc-kicker{margin:4px 0 0;font-size:12px;color:rgba(226,232,240,.9);font-weight:800;max-width:66ch;line-height:1.35;}
    .disc-icon{width:34px;height:34px;border-radius:12px;display:inline-flex;align-items:center;justify-content:center;border:1px solid rgba(148,196,255,.45);background:rgba(15,23,42,.5);box-shadow:0 10px 30px rgba(0,0,0,.35);font-weight:900;}
    .disc-head-left{display:flex;gap:12px;align-items:flex-start;}
    .disc-close{background:rgba(248,250,252,.06);border:1px solid rgba(148,196,255,.35);color:#e5e7eb;border-radius:12px;padding:8px 10px;font-weight:900;cursor:pointer;}
    .disc-close:hover{filter:brightness(1.08)}
    .disc-body{position:relative;padding:14px 16px 12px;font-size:14px;line-height:1.55;color:#0b1120;overflow:auto;max-height:calc(86vh - 62px - 74px);font-weight:700;}
    .disc-body p{margin:0 0 10px;font-weight:700;color:#0b1120;}
    .disc-body strong{font-weight:900;color:#020617;}
    .disc-sections{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
    @media(max-width:860px){.disc-sections{grid-template-columns:1fr;}}
    .disc-section{border:1px solid #e5e7eb;border-radius:16px;background:#ffffff;box-shadow:0 10px 26px rgba(0,0,0,.06);overflow:hidden;}
    .disc-sec-head{display:flex;gap:10px;align-items:flex-start;padding:12px 12px;background:linear-gradient(180deg,#ffffff,#f8fafc);border-bottom:1px solid #e5e7eb;}
    .disc-sec-badge{width:30px;height:30px;border-radius:12px;display:inline-flex;align-items:center;justify-content:center;font-weight:900;color:#0b1120;border:1px solid rgba(56,189,248,.35);background:rgba(56,189,248,.12);}
    .disc-sec-title{margin:0;font-size:13px;font-weight:900;color:#0b1120;}
    .disc-sec-sub{margin:2px 0 0;font-size:11px;color:#64748b;font-weight:800;line-height:1.35;}
    .disc-sec-body{padding:12px 12px 10px;font-size:13px;color:#0b1120;}
    .disc-sec-body ul{margin:0;padding-left:18px;display:grid;gap:8px;}
    .disc-sec-body li{margin:0;}
    .disc-footer-note{margin-top:12px;padding:12px;border-radius:16px;border:1px dashed rgba(15,23,42,.25);background:rgba(248,250,252,.9);font-size:12px;color:#0f172a;font-weight:800;}
    .disc-actions{position:relative;display:flex;gap:10px;justify-content:flex-end;padding:12px 16px;background:linear-gradient(180deg,#f8fafc,#ffffff);border-top:1px solid #e5e7eb;}
    .disc-actions .btn{min-width:140px}
    .btn-accept{border:1px solid rgba(34,197,94,.35);background:linear-gradient(180deg, rgba(34,197,94,.18), rgba(34,197,94,.08));color:#0b1120;}
    .btn-accept:hover{filter:brightness(1.03)}

    @keyframes phcFadeIn{to{opacity:1;transform:translateY(0);}}
    .cta-secondary{transition: opacity .35s ease, transform .35s ease;}
    .cta-secondary.visible{opacity:1 !important;pointer-events:auto !important;transform:translateY(0);}

    @media (max-width: 900px){
      .chat-launcher{right:14px;bottom:calc(14px + env(safe-area-inset-bottom));}
      .chat-peek{display:none;}
      .chat-window{left:12px;right:12px;width:auto;bottom:calc(86px + env(safe-area-inset-bottom));max-height:78vh;}
      /* Keep Disclaimer accessible but out of the way of bottom-sheet modals */
      .disc-btn{left:14px;right:auto;bottom:calc(86px + env(safe-area-inset-bottom));padding:8px 12px;font-size:11px;z-index:26000;opacity:.92;}
    }

    /* Hide the floating Disclaimer button while any modal is open (prevents overlap on mobile) */
    body.modal-open .disc-btn{display:none !important;}

    /* ================== PHC MOBILE FULLSCREEN PATCH ================== */
    @media (max-width: 600px){
      #phcModal{
        align-items:stretch !important;
        padding:0 !important;
      }
      #phcModal .card{
        width:100vw !important;
        height:100dvh !important;
        height:100vh !important;
        max-width:100% !important;
        max-height:none !important;
        border-radius:0 !important;
        margin:0 !important;
      }
      #phcModal .card-body{
        height:100%;
        overflow-y:auto;
        -webkit-overflow-scrolling:touch;
      }
      /* Ensure mobile nav stays visible */
      .phc-mobile-nav{
        position:sticky;
        bottom:0;
        background:linear-gradient(180deg, rgba(248,250,252,0), rgba(248,250,252,1) 32%);
        padding-top:10px;
        padding-bottom:calc(10px + env(safe-area-inset-bottom));
        z-index:10;
      }
      /* Result section on mobile */
      #phcResultMobile{
        display:block;
        width:100%;
      }
      #phcResultMobile .phc-loyalty{
        margin-top:12px;
      }
      #phcResultMobile .phc-loyalty .btn{
        width:100%;
      }
    }
  </style>
</head>

<body>
  <section class="hero">
    <!-- Rotating background images (PNG) -->
    <div class="hero-rotator" aria-hidden="true">
      <img class="hero-slide active" id="heroImg0" alt="" loading="eager" decoding="async" src="hero-house.png">
      <img class="hero-slide" id="heroImg1" alt="" loading="eager" decoding="async" src="hero-auto.png">
      <img class="hero-slide" id="heroImg2" alt="" loading="eager" decoding="async" src="hero-business.png">
    </div>

    <div class="hero-content">
      <h1 class="hero-headline" id="heroHeader" data-i18n="hero_header_home">Home Insurance</h1>

      <div class="hero-cta-wrap">
        <p class="phc-hook-hero attn" id="phcHook" data-i18n="phc_hook_v1">If your life looks different than when you started your policy, your coverage may not match anymore.</p>
        <button class="cta cta-secondary" id="openHealthCheck" type="button">30-Second Policy Health Check</button>
        <button class="cta cta-secondary" id="openFunnel" type="button" data-i18n="cta_check" aria-hidden="true" style="opacity:0;pointer-events:none;">Check My Options</button>
        <div class="cta-micro" id="ctaMicro">2 minutes • Not a quote • Agent follow-up</div>
      </div>
    </div>
  </section>

  <!-- =====================
  // POLICY HEALTH CHECK (SEPARATE TOOL)
  - Separate from the lead form
  - Finishes into "Check My Options"
  ===================== -->
  <div class="modal-overlay" id="phcModalOverlay"></div>
  <div class="modal" id="phcModal">
    <div class="card" role="dialog" aria-label="30-Second Policy Health Check">
      <div class="card-head">
        <div>
          <h2>30-Second Policy Health Check</h2>
          <p>General info only — a licensed agent reviews before any quote, application, binding, or policy change.</p>
        </div>
        <button class="icon-btn" id="phcCloseModal" type="button">✕</button>
      </div>

      <div class="card-body">
        <div class="phc-wrap" style="margin:0; padding:0; max-width:960px;">
          <div class="phc-card">
            <div class="phc-header">
              <div class="phc-badge">✓</div>
              <div>
                <p class="phc-title" style="margin:0;">Policy Health Check</p>
                <p class="phc-hook" style="margin:6px 0 0;">Answer a few quick questions to spot common coverage gaps (general info only; agent review required).</p>
              </div>
            </div>

            <!-- Desktop question grid (required for desktop scoring) -->
            <div class="phc-desktop-grid" id="phcDesktopGrid">
              <div class="phc-question">
                <p class="phc-q-title" style="margin:0 0 8px;">1) Any life changes in the last 12 months?</p>
                <div class="phc-grid" id="phcChanges">
                  <label class="phc-chip"><input type="checkbox" value="Moved" /> Moved</label>
                  <label class="phc-chip"><input type="checkbox" value="New vehicle" /> New vehicle</label>
                  <label class="phc-chip"><input type="checkbox" value="New drivers" /> New drivers</label>
                  <label class="phc-chip"><input type="checkbox" value="Home upgrades" /> Home upgrades</label>
                  <label class="phc-chip"><input type="checkbox" value="Business use" /> Business use</label>
                  <label class="phc-chip"><input type="checkbox" value="Claims" /> Claims</label>
                  <label class="phc-chip"><input type="checkbox" value="None" /> None</label>
                </div>
                <div class="hint" style="margin-top:6px;">Choose any that apply. (General info only.)</div>
              </div>

              <div class="phc-question">
                <div class="grid" style="grid-template-columns:1fr 1fr;gap:12px;">
                  <div class="field">
                    <label for="phcProperty">2) Property situation *</label>
                    <select id="phcProperty" aria-label="Property situation" required>
                      <option value="">Select…</option>
                      <option>Primary home</option>
                      <option>Condo / Townhome</option>
                      <option>Landlord / Rental property</option>
                      <option>Renters policy</option>
                      <option>Not sure</option>
                    </select>
                  </div>

                  <div class="field">
                    <label for="phcDeductible">3) Comfortable out-of-pocket if a claim happened tomorrow? *</label>
                    <select id="phcDeductible" aria-label="Deductible comfort" required>
                      <option value="">Select…</option>
                      <option>$500–$1,000</option>
                      <option>$1,500–$2,500</option>
                      <option>$2,500–$5,000+</option>
                      <option>Not sure</option>
                    </select>
                  </div>

                  <div class="field">
                    <label for="phcLiability">4) If you were sued after an accident/injury, how protected do you feel? *</label>
                    <select id="phcLiability" aria-label="Liability confidence" required>
                      <option value="">Select…</option>
                      <option>Very protected</option>
                      <option>Somewhat protected</option>
                      <option>Not protected</option>
                      <option>Not sure</option>
                    </select>
                  </div>

                  <div class="field">
                    <label for="phcReview">5) Last full policy review with a licensed agent? *</label>
                    <select id="phcReview" aria-label="Last review" required>
                      <option value="">Select…</option>
                      <option>Within 12 months</option>
                      <option>1–3 years</option>
                      <option>3+ years</option>
                      <option>Not sure</option>
                    </select>
                  </div>
                </div>
              </div>

              <div class="phc-question">
                <p class="phc-q-title" style="margin:0 0 8px;">Optional: Any property risk flags?</p>
                <div class="phc-grid" id="phcRisks">
                  <label class="phc-chip"><input type="checkbox" value="Wildfire exposure" /> Wildfire exposure</label>
                  <label class="phc-chip"><input type="checkbox" value="Roof age 15+" /> Roof age 15+</label>
                  <label class="phc-chip"><input type="checkbox" value="Prior hail claims" /> Prior hail claims</label>
                  <label class="phc-chip"><input type="checkbox" value="Vacant / seasonal" /> Vacant / seasonal</label>
                  <label class="phc-chip"><input type="checkbox" value="Trampoline / pool" /> Trampoline / pool</label>
                  <label class="phc-chip"><input type="checkbox" value="Dog liability" /> Dog liability</label>
                  <label class="phc-chip"><input type="checkbox" value="None" /> None</label>
                </div>
                <div class="hint" style="margin-top:6px;">Optional — choose any that apply. (General info only.)</div>
              </div>
            </div>

            <!-- Desktop actions (visible): compute + show result -->
            <div class="row" id="phcDesktopActions" style="justify-content:flex-start; margin-top:14px; gap:10px;">
              <button class="btn btn-primary" id="phcFinishDesktop" type="button">Finish &amp; Show Result</button>
              <button class="btn" id="phcReset" type="button">Reset</button>
              <div class="hint" style="align-self:center;">Select the required fields (*) to unlock your diagnostic.</div>
            </div>

            <div class="phc-result" id="phcResult" aria-live="polite">
              <div class="phc-result-top">
                <div class="phc-result-left">
                  <span class="phc-dot" id="phcDot" aria-hidden="true"></span>
                  <div>
                    <div class="phc-result-label" id="phcLabel">Green</div>
                  </div>
                </div>
                <button class="btn phc-run" id="phcRun" type="button">Show my result</button>
              </div>

              <div class="phc-result-copy" id="phcCopy"></div>
              <div class="phc-subhead" id="phcSubhead">Most people don't switch because they're happy — they stay because nothing triggered a review. We help you check if your coverage still makes sense today.</div>
              <ul class="phc-result-why" id="phcWhy"></ul>

              <!-- Red-result interstitial: message + lead CTA -->
              <div class="phc-loyalty" id="phcLoyalty" aria-live="polite">
                <p class="m" id="phcLoyaltyMsg">Loyalty isn't the same as protection.</p>
                <button class="btn btn-primary" id="phcLeadCta" type="button">Check My Options</button>
              </div>

              <div class="phc-result-actions">
                <button class="btn btn-primary phc-continue" id="phcCta" type="button">Continue to Options</button>
              </div>
            </div>

            <!-- Mobile: tap-to-advance flow -->
            <div class="phc-mobile-flow" id="phcMobileFlow" aria-label="Policy Health Check mobile flow">
              <div class="phc-q" id="phcQ0">
                <p class="phc-q-title">1) Any life changes in the last 12 months?</p>
                <p class="phc-q-hint">Tap any that apply (you can choose multiple). Then continue.</p>
                <div class="phc-answers" id="phcMobileChanges"></div>
                <div class="phc-mobile-nav">
                  <button class="btn" type="button" id="phcBack0" disabled>Back</button>
                  <button class="btn btn-primary" type="button" id="phcNext0">Continue</button>
                </div>
              </div>

              <div class="phc-q" id="phcQ1" style="display:none;">
                <p class="phc-q-title">2) Property situation *</p>
                <p class="phc-q-hint">Tap one option.</p>
                <div class="phc-answers" id="phcMobileProperty"></div>
                <div class="phc-mobile-nav">
                  <button class="btn" type="button" id="phcBack1">Back</button>
                  <button class="btn btn-primary" type="button" id="phcNext1">Continue</button>
                </div>
              </div>

              <div class="phc-q" id="phcQ2" style="display:none;">
                <p class="phc-q-title">3) Comfortable out-of-pocket if a claim happened tomorrow? *</p>
                <p class="phc-q-hint">Tap one option.</p>
                <div class="phc-answers" id="phcMobileDeductible"></div>
                <div class="phc-mobile-nav">
                  <button class="btn" type="button" id="phcBack2">Back</button>
                  <button class="btn btn-primary" type="button" id="phcNext2">Continue</button>
                </div>
              </div>

              <div class="phc-q" id="phcQ3" style="display:none;">
                <p class="phc-q-title">4) If you were sued after an accident/injury, how protected do you feel? *</p>
                <p class="phc-q-hint">Tap one option.</p>
                <div class="phc-answers" id="phcMobileLiability"></div>
                <div class="phc-mobile-nav">
                  <button class="btn" type="button" id="phcBack3">Back</button>
                  <button class="btn btn-primary" type="button" id="phcNext3">Continue</button>
                </div>
              </div>

              <div class="phc-q" id="phcQ4" style="display:none;">
                <p class="phc-q-title">5) Last full policy review with a licensed agent? *</p>
                <p class="phc-q-hint">Tap one option.</p>
                <div class="phc-answers" id="phcMobileReview"></div>
                <div class="phc-mobile-nav">
                  <button class="btn" type="button" id="phcBack4">Back</button>
                  <button class="btn btn-primary" type="button" id="phcNext4">Continue</button>
                </div>
              </div>

              <div class="phc-q" id="phcQ5" style="display:none;">
                <p class="phc-q-title">Optional: Any property risk flags?</p>
                <p class="phc-q-hint">Tap any that apply (you can choose multiple). Then finish.</p>
                <div class="phc-answers" id="phcMobileRisks"></div>
                <div class="phc-mobile-nav">
                  <button class="btn" type="button" id="phcBack5">Back</button>
                  <button class="btn btn-primary" type="button" id="phcFinish">Finish</button>
                </div>
              </div>

              <div class="phc-q" id="phcQDone" style="display:none;">
                <p class="phc-q-title">✅ Policy Health Check complete</p>
                <p class="phc-q-hint">Based on your answers:</p>
                <div class="phc-result show" id="phcResultMobile"></div>
              </div>
            </div>

          </div><!-- /.phc-card -->
        </div><!-- /.phc-wrap -->
      </div><!-- /.card-body -->
    </div><!-- /.card -->
  </div><!-- /#phcModal -->

  <!-- Lead Funnel Modal (fallback if CLICKFUNNEL_URL is blank) -->
  <div class="modal-overlay" id="modalOverlay"></div>
  <div class="modal" id="modal">
    <div class="card" role="dialog" aria-label="Options pre-check form">
      <div class="card-head">
        <div>
          <h2>Quick Options Pre-Check</h2>
          <p>2 minutes. Not a quote. A licensed agent reviews and follows up with carrier-agnostic options.</p>
        </div>
        <button class="icon-btn" id="closeModal" type="button">✕</button>
      </div>

      <div class="card-body">
        <form id="leadForm">
          <!-- Stepper (mobile-first) -->
          <div class="stepper" id="stepper" aria-label="Form progress">
            <div class="stepper-top">
              <div class="stepper-kicker" id="stepperKicker">Step 1 of 4</div>
              <div class="stepper-title">A quick pre-check</div>
            </div>
            <div class="stepper-dots" role="presentation">
              <span class="dotx active" data-dot="0"></span>
              <span class="dotx" data-dot="1"></span>
              <span class="dotx" data-dot="2"></span>
              <span class="dotx" data-dot="3"></span>
            </div>
            <div class="stepper-bar" aria-hidden="true"><span class="stepper-bar-fill" id="stepperBarFill"></span></div>
          </div>

          <div class="steps" id="steps">
            <!-- STEP 1 -->
            <section class="step active" data-step="0" aria-label="Step 1">
              <div class="grid">
                <div class="field">
                  <label for="firstName">First name *</label>
                  <input id="firstName" name="firstName" autocomplete="given-name" required />
                </div>
                <div class="field">
                  <label for="lastName">Last name *</label>
                  <input id="lastName" name="lastName" autocomplete="family-name" required />
                </div>
                <div class="field" style="grid-column:1 / -1;">
                  <label for="zip">ZIP *</label>
                  <input id="zip" name="zip" inputmode="numeric" pattern="[0-9]{5}" placeholder="81501" required />
                  <div class="hint">Example reference ZIP: 81501</div>
                </div>
              </div>
            </section>

            <!-- STEP 2 -->
            <section class="step" data-step="1" aria-label="Step 2">
              <div class="grid">
                <div class="field">
                  <label for="email">Email *</label>
                  <input id="email" name="email" type="email" autocomplete="email" required />
                </div>
                <div class="field">
                  <label for="phone">Mobile phone *</label>
                  <input id="phone" name="phone" type="tel" autocomplete="tel" required />
                </div>
                <div class="field">
                  <label for="homeowner">Home status *</label>
                  <select id="homeowner" name="homeowner" required>
                    <option value="">Select…</option>
                    <option>Own</option>
                    <option>Rent</option>
                    <option>Buying soon</option>
                  </select>
                </div>
                <div class="field">
                  <label for="vehicles">Vehicles insured *</label>
                  <select id="vehicles" name="vehicles" required>
                    <option value="">Select…</option>
                    <option>1</option><option>2</option><option>3</option><option>4+</option>
                  </select>
                </div>
                <div class="field" style="grid-column:1 / -1;">
                  <label for="timeframe">When do you need this? *</label>
                  <select id="timeframe" name="timeframe" required>
                    <option value="">Select…</option>
                    <option>ASAP</option>
                    <option>Within 7 days</option>
                    <option>Within 30 days</option>
                    <option>Just exploring</option>
                  </select>
                </div>
              </div>
            </section>

            <!-- STEP 3 -->
            <section class="step" data-step="2" aria-label="Step 3">
              <div class="grid">
                <div class="field" style="grid-column:1 / -1;">
                  <label for="roofAge">Roof age</label>
                  <select id="roofAge" name="roofAge">
                    <option value="">Select…</option>
                    <option>0-5</option><option>6-10</option><option>11-15</option><option>16-20</option><option>21+</option><option>Not sure</option>
                  </select>
                </div>
                <div class="field" style="grid-column:1 / -1;">
                  <label for="notes">Notes (optional)</label>
                  <textarea id="notes" name="notes" placeholder="Any details that help (hail claim history, wildfire concerns, bundling, etc.)"></textarea>
                </div>
              </div>
            </section>

            <!-- STEP 4 -->
            <section class="step" data-step="3" aria-label="Step 4">
              <div class="grid">
                <div class="field" style="grid-column:1 / -1;">
                  <label style="display:flex;gap:10px;align-items:flex-start;font-weight:800;color:#0f172a;">
                    <input id="consent" name="consent" type="checkbox" required style="margin-top:2px;" />
                    I agree to be contacted by phone, SMS, and email about insurance options. Msg &amp; data rates may apply.
                  </label>
                </div>
              </div>
            </section>
          </div>

          <!-- Desktop buttons -->
          <div class="row row-desktop" id="rowDesktop">
            <button class="btn" id="cancelBtn" type="button">Cancel</button>
            <button class="btn btn-primary" id="submitBtn" type="submit">Submit</button>
          </div>

          <!-- Mobile step buttons -->
          <div class="row row-mobile" id="rowMobile" aria-label="Step controls">
            <button class="btn" id="stepBack" type="button">Back</button>
            <button class="btn btn-primary" id="stepNext" type="button">Next</button>
            <button class="btn btn-primary" id="stepSubmit" type="submit" style="display:none;">Submit</button>
          </div>

          <div class="status" id="formStatus"></div>
          
          <!-- PDF Results Panel (shown after successful submission) -->
          <div class="pdf-results-panel" id="pdfResultsPanel">
            <p class="pdf-results-title">✅ Thanks — want a PDF summary for your records?</p>
            <p class="pdf-results-text">Get a PDF with your form details and Policy Health Check results (if available).</p>
            <div class="pdf-email-gate" id="pdfEmailGate" style="display:none;">
              <div class="field">
                <label for="pdfEmail">Confirm your email</label>
                <input id="pdfEmail" name="pdfEmail" type="email" placeholder="your@email.com" />
              </div>
            </div>
            <button class="btn btn-primary" id="downloadPdfBtn" type="button">Download PDF</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Disclaimer launcher -->
  <button class="disc-btn" id="openDisclaimer" type="button" data-i18n="disclaimer_btn">Disclaimer</button>

  <!-- Disclaimer modal -->
  <div class="disc-overlay" id="discOverlay"></div>
  <div class="disc-modal" id="discModal" role="dialog" aria-label="Legal disclaimer">
    <div class="disc-card">
      <div class="disc-head">
        <div class="disc-head-left">
          <div class="disc-icon">⚖</div>
          <div>
            <h2>Legal Disclaimer</h2>
            <div class="disc-kicker">Please review. This site includes AI-assisted information. <b>Human review is required</b> before any quote, application, binding, or policy change.</div>
          </div>
        </div>
        <button class="disc-close" id="discClose" type="button" aria-label="Close disclaimer">Close ✕</button>
      </div>

      <div class="disc-body">
        <div class="disc-sections">
          <section class="disc-section">
            <div class="disc-sec-head">
              <div class="disc-sec-badge">i</div>
              <div>
                <p class="disc-sec-title">General information only</p>
                <p class="disc-sec-sub">Not legal, tax, or financial advice</p>
              </div>
            </div>
            <div class="disc-sec-body">
              <ul>
                <li>This page and <strong>PolicyPro™</strong> provide <strong>general educational information</strong> about insurance concepts.</li>
                <li>Nothing here is legal advice, tax advice, or a substitute for professional guidance.</li>
                <li>Examples (including ZIP <strong>81501</strong>) are <strong>illustrative only</strong>.</li>
              </ul>
            </div>
          </section>

          <section class="disc-section">
            <div class="disc-sec-head">
              <div class="disc-sec-badge">AI</div>
              <div>
                <p class="disc-sec-title">AI disclosure</p>
                <p class="disc-sec-sub">AI output can be wrong or incomplete</p>
              </div>
            </div>
            <div class="disc-sec-body">
              <ul>
                <li><strong>PolicyPro™</strong> includes automated and artificial-intelligence–generated responses for general informational purposes.</li>
                <li>AI output may be incomplete, inaccurate, or outdated and must not be relied upon as a definitive statement of coverage, pricing, underwriting eligibility, or claim outcome.</li>
                <li>AI responses do <strong>not</strong> replace advice from a licensed insurance producer.</li>
              </ul>
            </div>
          </section>

          <section class="disc-section">
            <div class="disc-sec-head">
              <div class="disc-sec-badge">✓</div>
              <div>
                <p class="disc-sec-title">Human review required</p>
                <p class="disc-sec-sub">Before quotes, applications, or changes</p>
              </div>
            </div>
            <div class="disc-sec-body">
              <ul>
                <li>Any quote indications, coverage discussions, or next steps require <strong>review and confirmation</strong> by a licensed insurance agent before any application is submitted or coverage is bound.</li>
                <li>Nothing on this page constitutes an offer to sell insurance or bind coverage.</li>
              </ul>
            </div>
          </section>

          <section class="disc-section">
            <div class="disc-sec-head">
              <div class="disc-sec-badge">🛡</div>
              <div>
                <p class="disc-sec-title">Coverage &amp; claims limitations</p>
                <p class="disc-sec-sub">Carrier rules and policy terms control</p>
              </div>
            </div>
            <div class="disc-sec-body">
              <ul>
                <li>Coverage, eligibility, rates, discounts, underwriting, and availability vary by carrier and are subject to policy terms, conditions, exclusions, limits, and deductibles.</li>
                <li>Claim scenario walkthroughs are general and may not apply to your situation. Always follow your policy and carrier instructions. If there is immediate danger, call emergency services.</li>
              </ul>
            </div>
          </section>
        </div>

        <div class="disc-footer-note">
          <strong>Consent &amp; privacy:</strong> By submitting your information, you authorize contact by phone, SMS, and email about insurance options (msg &amp; data rates may apply). Information may be stored in a secure Google Sheet and emailed to the business inbox for follow-up. Do not submit sensitive information you do not want transmitted electronically.
        </div>
      </div>

      <div class="disc-actions">
        <button class="btn btn-accept" id="discAccept" type="button">I Accept</button>
        <button class="btn btn-primary" id="discClose2" type="button">Close</button>
      </div>
    </div>
  </div>

  <!-- Channel.io-style launcher -->
  <div class="chat-launcher" id="chatBtn" aria-label="Open PolicyPro chat" title="Ask PolicyPro™ a question">
    <div class="chat-peek" aria-hidden="true">
      <div class="chat-label" data-i18n="chat_peek_label">Need help?</div>
      <div class="chat-name" data-i18n="chat_peek_name">Chat with PolicyPro™</div>
    </div>
    <div class="chat-bubble" role="button" aria-label="Chat bubble">
      <div class="chat-avatar">PP</div>
    </div>
  </div>

  <div class="chat-window" id="chatWindow" aria-label="PolicyPro widget" role="dialog">
    <div class="pp-widget">
      <div class="pp-top" aria-hidden="true">
        <div class="pp-topbar">
          <div class="pp-brand">PolicyPro™</div>
        </div>
      </div>

      <div class="pp-body">
        <!-- HOME -->
        <div class="pp-screen active" id="ppScreenHome">
          <div class="pp-home-card">
            <div class="pp-home-row">
              <div class="pp-avatar">PP</div>
              <div>
                <p class="pp-home-title" data-i18n="pp_home_title">Hi — how can we help?</p>
                <p class="pp-home-sub" data-i18n="pp_home_sub">Ask a Colorado home or auto insurance question. General info only — a licensed agent reviews before any quote, application, or binding.</p>
              </div>
            </div>
            <button class="pp-primary" id="ppStartChat" type="button"><span data-i18n="pp_start_chat">Start a chat</span> <span aria-hidden="true">➤</span></button>
          </div>
          <div class="pp-footer-note" data-i18n="pp_powered">Powered by PolicyPro</div>
        </div>

        <!-- MESSAGES -->
        <div class="pp-screen" id="ppScreenMessages">
          <div class="pp-messages-wrap">
            <div class="chat-main">
              <div class="chat-messages" id="chatMessages" aria-live="polite"></div>
              <form class="chat-inputbar" id="chatForm" autocomplete="off">
                <input class="chat-input" id="chatInput" type="text" placeholder="Ask about hail deductibles, wildfire coverage, bundling…" data-i18n-placeholder="chat_placeholder" />
                <button class="send-btn" id="chatSend" type="submit" data-i18n="chat_send">Send</button>
              </form>
            </div>
          </div>
        </div>

        <!-- SETTINGS -->
        <div class="pp-screen" id="ppScreenSettings">
          <div class="pp-settings">
            <h3 data-i18n="settings_title">Settings</h3>
            <div class="pp-setting-item"><div class="k" data-i18n="settings_contact">Contact</div><div class="v" id="ppAgentEmail">securechoicein@gmail.com</div></div>
            <div class="pp-setting-item">
              <div class="k" data-i18n="settings_language">Language</div>
              <div class="v">
                <select id="ppLangSelect" class="pp-select" aria-label="Select language">
                  <option value="en">English</option>
                  <option value="es">Spanish</option>
                  <option value="ja">Japanese</option>
                  <option value="zh">Chinese</option>
                  <option value="fr">French</option>
                  <option value="ru">Russian</option>
                </select>
              </div>
            </div>
            <div class="pp-setting-item"><div class="k" data-i18n="settings_disclaimer">Disclaimer</div><div class="v" data-i18n="settings_available">Available</div></div>
            <a class="pp-setting-link" href="#" id="ppOpenDisclaimerLink" data-i18n="settings_open_disclaimer">Open legal disclaimer</a>
          </div>
        </div>
      </div><!-- /.pp-body -->

      <div class="pp-tabs" role="tablist" aria-label="Widget tabs">
        <button class="pp-tab active" id="ppTabHome" type="button" role="tab" aria-selected="true" aria-controls="ppScreenHome">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M3 10.5 12 3l9 7.5"/><path d="M5 10v10h14V10"/></svg>
          <span data-i18n="tab_home">Home</span>
        </button>
        <button class="pp-tab" id="ppTabMessages" type="button" role="tab" aria-selected="false" aria-controls="ppScreenMessages">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M21 15a4 4 0 0 1-4 4H8l-5 3V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"/></svg>
          <span data-i18n="tab_messages">Messages</span>
        </button>
        <button class="pp-tab" id="ppTabSettings" type="button" role="tab" aria-selected="false" aria-controls="ppScreenSettings">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 15.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z"/><path d="M19.4 15a1.7 1.7 0 0 0 .3 1.8l.1.1a2 2 0 0 1-1.4 3.4h-.2a1.8 1.8 0 0 0-1.7 1.3 2 2 0 0 1-3.8 0 1.8 1.8 0 0 0-1.7-1.3H9a2 2 0 0 1-1.4-3.4l.1-.1A1.7 1.7 0 0 0 8.6 15a1.8 1.8 0 0 0-.7-1.7 2 2 0 0 1 0-3.1 1.8 1.8 0 0 0 .7-1.7 1.7 1.7 0 0 0-.3-1.8l-.1-.1A2 2 0 0 1 9.6 3h.2a1.8 1.8 0 0 0 1.7-1.3 2 2 0 0 1 3.8 0 1.8 1.8 0 0 0 1.7 1.3h.2a2 2 0 0 1 1.4 3.4l-.1.1a1.7 1.7 0 0 0-.3 1.8 1.8 1.8 0 0 0 .7 1.7 2 2 0 0 1 0 3.1 1.8 1.8 0 0 0-.7 1.7 1.7 1.7 0 0 0 .3 1.8l.1.1a2 2 0 0 1-1.4 3.4h-.2a1.8 1.8 0 0 0-1.7 1.3 a2 2 0 0 1-3.8 0"/></svg>
          <span data-i18n="tab_settings">Settings</span>
        </button>
      </div>

      <button class="pp-close-fab" id="closeChat" aria-label="Close chat" type="button">✕</button>
    </div><!-- /.pp-widget -->
  </div><!-- /#chatWindow -->

  <!-- ================= AGENT INFO BAR (OUTLINED CALLOUT STYLE) ================= -->
  <style>
    :root{
      /* Outlined pill look (matches your callout outline) */
      --agent-bar-bg: rgba(255,255,255,0.18); /* light tint so it blends on hero */
      --agent-bar-border: rgba(255,255,255,0.35); /* visible outline */
      --agent-bar-text: rgba(255,255,255,0.92);
      --agent-bar-subtext: rgba(255,255,255,0.72);
      --agent-bar-shadow: 0 10px 28px rgba(0,0,0,0.18);
      --agent-radius: 18px;

      /* Panel (still readable, slightly denser) */
      --agent-panel-bg: rgba(255,255,255,0.86);
      --agent-panel-border: rgba(0,0,0,0.10);
      --agent-panel-shadow: 0 18px 50px rgba(0,0,0,0.18);

      --agent-side-gap: clamp(10px, 3vw, 18px);
      --agent-top-gap: clamp(10px, 2.5vw, 16px);
      --agent-bar-h: 48px;
      --agent-max-w: 980px;
    }
    body{
      padding-top: calc(var(--agent-top-gap) + env(safe-area-inset-top, 0px) + var(--agent-bar-h) + 12px);
    }
    .agent-bar{
      position: fixed;
      top: calc(var(--agent-top-gap) + env(safe-area-inset-top, 0px));
      left: var(--agent-side-gap);
      right: var(--agent-side-gap);
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 6px 8px;
      border-radius: var(--agent-radius);

      /* OUTLINE LOOK */
      background: var(--agent-bar-bg);
      border: 1px solid var(--agent-bar-border);

      /* iOS-ish glass */
      backdrop-filter: blur(16px) saturate(160%);
      -webkit-backdrop-filter: blur(16px) saturate(160%);

      /* subtle “floating” */
      box-shadow: var(--agent-bar-shadow);
    }
    /* Optional: thin inner highlight */
    .agent-bar::before{
      content:"";
      position:absolute;
      inset: 1px;
      border-radius: calc(var(--agent-radius) - 2px);
      border: 1px solid rgba(255,255,255,0.18);
      pointer-events:none;
    }
    @media (min-width: 900px){
      .agent-bar{
        max-width: var(--agent-max-w);
        left: 50%;
        right: auto;
        transform: translateX(-50%);
      }
    }

    .agent-toggle, .lang-trigger{
      min-height: 40px;
      background: transparent;
      border: none;
      cursor: pointer;
      -webkit-tap-highlight-color: transparent;
      color: var(--agent-bar-text);
    }
    .agent-toggle{
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 8px 12px;
      border-radius: 14px;
      font-weight: 700;
    }
    .agent-toggle:hover{ background: rgba(255,255,255,0.08); }

    /* Hamburger icon (outlined) */
    .hamburger{
      width: 22px;
      height: 22px;
      border-radius: 999px;
      display: grid;
      place-items: center;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.22);
    }
    .hamburger span{
      display:block;
      width: 12px;
      height: 2px;
      background: rgba(255,255,255,0.92);
      border-radius: 999px;
      margin: 2px 0;
      transition: transform .18s ease, opacity .18s ease;
    }
    .agent-toggle[aria-expanded="true"] .hamburger span:nth-child(1){ transform: translateY(4px) rotate(45deg); }
    .agent-toggle[aria-expanded="true"] .hamburger span:nth-child(2){ opacity: 0; }
    .agent-toggle[aria-expanded="true"] .hamburger span:nth-child(3){ transform: translateY(-4px) rotate(-45deg); }

    .agent-toggle .label{ display:flex; flex-direction:column; line-height:1.05; }
    .agent-toggle .title{ font-size: 12.5px; }
    .agent-toggle .hint{ font-size: 11px; color: var(--agent-bar-subtext); }

    /* Language trigger with outline */
    .agent-right{ display:flex; align-items:center; gap:8px; }
    .lang-trigger{
      display:inline-flex;
      align-items:center;
      gap:8px;
      height: 40px;
      padding: 0 10px;
      border-radius: 14px;
      background: rgba(255,255,255,0.08);
      border: 1px solid rgba(255,255,255,0.22);
      font-weight: 800;
    }
    .lang-trigger:hover{ background: rgba(255,255,255,0.14); }
    .lang-pill{ font-size: 12px; letter-spacing: .4px; }
    .lang-globe{ font-size: 18px; line-height: 1; }
    .chev{ font-size: 12px; opacity: .85; transform: translateY(-1px); }

    /* Language dropdown */
    .lang-menu[hidden]{ display:none !important; }
    .lang-menu{
      position: fixed;
      z-index: 10000;
      min-width: 240px;
      background: rgba(255,255,255,0.92);
      border: 1px solid rgba(0,0,0,0.10);
      border-radius: 16px;
      box-shadow: 0 22px 60px rgba(0,0,0,0.18);
      backdrop-filter: blur(22px) saturate(180%);
      -webkit-backdrop-filter: blur(22px) saturate(180%);
      overflow: hidden;
    }
    .lang-menu .menu-head{
      padding: 10px 12px;
      font-weight: 900;
      font-size: 12px;
      color: rgba(15,23,42,0.72);
      border-bottom: 1px solid rgba(0,0,0,0.06);
    }
    .lang-option{
      width: 100%;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap: 12px;
      padding: 12px 12px;
      background: transparent;
      border: 0;
      cursor: pointer;
      color: rgba(15,23,42,0.92);
      font-weight: 800;
      text-align: left;
    }
    .lang-option:hover{ background: rgba(15,23,42,0.06); }
    .lang-left{ display:flex; align-items:center; gap:10px; min-width:0; }
    .flag{
      width: 22px;
      height: 16px;
      border-radius: 4px;
      display:grid;
      place-items:center;
      font-size: 14px;
      background: rgba(15,23,42,0.06);
      border: 1px solid rgba(0,0,0,0.06);
      flex: 0 0 auto;
    }
    .lang-names{ display:flex; flex-direction:column; gap:2px; min-width:0; }
    .lang-name{ font-size: 13px; white-space: nowrap; overflow:hidden; text-overflow: ellipsis; }
    .lang-native{ font-size: 11px; color: rgba(15,23,42,0.60); white-space: nowrap; overflow:hidden; text-overflow: ellipsis; }
    .check{ font-size: 14px; opacity: .9; }

    /* Agent info panel */
    .agent-info-panel{
      position: fixed;
      top: calc(var(--agent-top-gap) + env(safe-area-inset-top, 0px) + var(--agent-bar-h) + 10px);
      left: var(--agent-side-gap);
      right: var(--agent-side-gap);
      z-index: 9998;
      background: var(--agent-panel-bg);
      border: 1px solid var(--agent-panel-border);
      border-radius: 18px;
      box-shadow: var(--agent-panel-shadow);
      backdrop-filter: blur(22px) saturate(180%);
      -webkit-backdrop-filter: blur(22px) saturate(180%);
    }
    @media (min-width: 900px){
      .agent-info-panel{
        max-width: var(--agent-max-w);
        left: 50%;
        right: auto;
        transform: translateX(-50%);
      }
    }
    .agent-info-panel[hidden]{ display:none !important; }
    .agent-info-content{
      display: grid;
      grid-template-columns: 120px 1fr;
      gap: 16px;
      padding: 16px;
    }
    @media (max-width: 560px){
      .agent-info-content{ grid-template-columns: 1fr; }
      .agent-toggle .hint{ display:none; }
    }
    .agent-logo{ width: 110px; filter: drop-shadow(0 2px 6px rgba(0,0,0,0.18)); }
    .agent-name{ font-size: 15px; font-weight: 900; margin-bottom: 6px; color: rgba(15,23,42,0.92); }
    .agent-details{ font-size: 13px; line-height: 1.55; color: rgba(15,23,42,0.90); }
    .agent-motto{ font-size: 12px; color: rgba(15,23,42,0.62); margin-top: 4px; }
  </style>

  <div class="agent-bar">
    <button class="agent-toggle" id="agentToggle" type="button" aria-expanded="false" aria-controls="agentInfoPanel">
      <span class="hamburger" aria-hidden="true"><span></span><span></span><span></span></span>
      <span class="label">
        <span class="title">Agent info</span>
        <span class="hint">Tap to view details</span>
      </span>
    </button>

    <div class="agent-right">
      <button class="lang-trigger" id="topLangBtn" type="button" aria-haspopup="menu" aria-expanded="false" aria-controls="langMenu" aria-label="Language: English">
        <span class="lang-pill" id="langPill">EN</span>
        <span class="lang-globe" aria-hidden="true">🌐</span>
        <span class="chev" aria-hidden="true">▾</span>
      </button>
    </div>
  </div>

  <div id="langMenu" class="lang-menu" hidden role="menu" aria-label="Choose language">
    <div class="menu-head">Language</div>
    <button class="lang-option" type="button" role="menuitemradio" data-lang="en" aria-checked="true">
      <span class="lang-left">
        <span class="flag" aria-hidden="true">🇺🇸</span>
        <span class="lang-names">
          <span class="lang-name">English</span>
          <span class="lang-native">English</span>
        </span>
      </span>
      <span class="check" aria-hidden="true">✓</span>
    </button>
    <button class="lang-option" type="button" role="menuitemradio" data-lang="es" aria-checked="false">
      <span class="lang-left">
        <span class="flag" aria-hidden="true">🇲🇽</span>
        <span class="lang-names">
          <span class="lang-name">Spanish</span>
          <span class="lang-native">Español</span>
        </span>
      </span>
      <span class="check" aria-hidden="true" style="opacity:0;">✓</span>
    </button>
    <button class="lang-option" type="button" role="menuitemradio" data-lang="vi" aria-checked="false">
      <span class="lang-left">
        <span class="flag" aria-hidden="true">🇻🇳</span>
        <span class="lang-names">
          <span class="lang-name">Vietnamese</span>
          <span class="lang-native">Tiếng Việt</span>
        </span>
      </span>
      <span class="check" aria-hidden="true" style="opacity:0;">✓</span>
    </button>
    <button class="lang-option" type="button" role="menuitemradio" data-lang="zh" aria-checked="false">
      <span class="lang-left">
        <span class="flag" aria-hidden="true">🇨🇳</span>
        <span class="lang-names">
          <span class="lang-name">Chinese</span>
          <span class="lang-native">中文</span>
        </span>
      </span>
      <span class="check" aria-hidden="true" style="opacity:0;">✓</span>
    </button>
  </div>

  <div id="agentInfoPanel" class="agent-info-panel" hidden aria-hidden="true">
    <div class="agent-info-content">
      <div>
        <img src="allstate-logo.png" alt="Allstate Logo" class="agent-logo">
        <div class="agent-motto">You’re in good hands®</div>
      </div>
      <div class="agent-details">
        <div class="agent-name">Gilbert Noel Jr.</div>
        <div><strong>License #</strong> 776994</div>
        <div style="margin-top:6px;"><strong>Address:</strong></div>
        <div>106 N Circle Dr.</div>
        <div>Colorado Springs, CO 80909</div>
      </div>
    </div>
  </div>

  <!-- ================= TRUST STRIP ================= -->
  <style>
    /* ================= TRUST STRIP ================= */
    .trust-strip{
      width: min(1100px, calc(100% - 24px));
      margin: 28px auto 40px;
    }
    .trust-card{
      display: grid;
      grid-template-columns: 1fr;
      gap: 12px;

      padding: 12px 14px;
      border-radius: 999px; /* pill shape like hero-line */

      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.30);

      backdrop-filter: blur(12px) saturate(160%);
      -webkit-backdrop-filter: blur(12px) saturate(160%);

      /* remove heavy card feeling */
      box-shadow: none;
    }

    @media (min-width: 860px){
      .trust-card{
        grid-template-columns: 360px 1px 1fr;
        align-items: center;
        gap: 16px;
      }
    }

    .trust-left{ display:flex; gap:14px; align-items:center; }
    .trust-stars{ font-size:18px; letter-spacing:2px; color:rgba(255,255,255,0.92); }
    .trust-score-num{ font-size:22px; font-weight:900; }
    .trust-score-out{ font-size:12px; opacity:.7; }
    .trust-source{ display:flex; gap:8px; margin-top:6px; font-size:12px; font-weight:800; }
    .trust-source-badge{
      width:28px; height:22px; border-radius:8px; display:grid; place-items:center;
      background:rgba(255,255,255,0.12); border:1px solid rgba(255,255,255,0.26);
    }
    .trust-divider{ display:none; width:1px; height:100%; background:rgba(255,255,255,0.24); }
    @media (min-width:860px){ .trust-divider{display:block;} }
    .trust-quote{ font-size:13px; line-height:1.45; transition:opacity .3s ease; }
    .trust-meta{ font-size:11.5px; opacity:.75; display:flex; gap:8px; align-items:center; }
    .trust-name{ font-weight:900; }
    .trust-verified{
      padding:4px 8px; border-radius:999px;
      background:rgba(255,255,255,0.10); border:1px solid rgba(255,255,255,0.22);
      font-weight:800;
    }
  </style>

  <section class="trust-strip" aria-label="Customer trust and testimonial">
    <div class="trust-card">
      <div class="trust-left">
        <div class="trust-stars" aria-label="4.67 out of 5 stars">★★★★☆</div>
        <div class="trust-score">
          <div>
            <span class="trust-score-num">4.67</span>
            <span class="trust-score-out">/ 5</span>
          </div>
          <div class="trust-source">
            <span class="trust-source-badge">TP</span>
            <span>Trustpilot-style rating</span>
          </div>
        </div>
      </div>

      <div class="trust-divider"></div>

      <div>
        <div class="trust-quote" id="trustQuote">
          “The Policy Health Check took under a minute and showed we were under-insured on liability. No pressure, just clear next steps.”
        </div>
        <div class="trust-meta">
          <span class="trust-name" id="trustName">— Emily R., Fort Collins, CO</span>
          <span>•</span>
          <span class="trust-verified">Sample feedback</span>
        </div>
      </div>
    </div>
  </section>

  <!-- ============================================================
  SCRIPTS
  NOTE: The only “fix” applied vs your pasted version is:
  - Removed the stray orphan </script> that was breaking parsing
  - Moved everything that was after </html> back inside <body>
  - Kept all behavior/styling identical
  ============================================================ -->

  <script>
    // =====================
    // GLOBAL MODAL CONTROL (CONSOLIDATED)
    // =====================
    (function(){
      function onReady(fn){
        if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', fn);
        else fn();
      }

      onReady(function(){
        // Prevent double-binding
        if(window.__modalHandlersBound) return;
        window.__modalHandlersBound = true;

        // ===== PHC MODAL (Policy Health Check) =====
        var phcModal = document.getElementById('phcModal');
        var phcOverlay = document.getElementById('phcModalOverlay');
        var phcClose = document.getElementById('phcCloseModal');
        var openHealthCheck = document.getElementById('openHealthCheck');

        window.__openPHCModal = function(){
          if(phcOverlay) phcOverlay.style.display = 'block';
          if(phcModal) phcModal.style.display = 'flex';
          document.body.style.overflow = 'hidden';
          document.body.classList.add('modal-open');
          if(typeof window.__PHC_SYNC_ON_OPEN === 'function'){
            try{ window.__PHC_SYNC_ON_OPEN(); }catch(e){ console.error('PHC sync failed:', e); }
          }
        };

        window.__closePHCModal = function(){
          if(phcOverlay) phcOverlay.style.display = 'none';
          if(phcModal) phcModal.style.display = 'none';
          document.body.style.overflow = '';
          document.body.classList.remove('modal-open');
        };

        if(openHealthCheck){
          openHealthCheck.addEventListener('click', function(e){
            e.preventDefault();
            window.__openPHCModal();
          });
          openHealthCheck.addEventListener('touchend', function(e){
            e.preventDefault();
            window.__openPHCModal();
          }, { passive:false });
        }

        if(phcClose) phcClose.addEventListener('click', window.__closePHCModal);
        if(phcOverlay) phcOverlay.addEventListener('click', window.__closePHCModal);

        // ===== LEAD MODAL (Check My Options) =====
        var modal = document.getElementById('modal');
        var overlay = document.getElementById('modalOverlay');
        var closeBtn = document.getElementById('closeModal');
        var cancelBtn = document.getElementById('cancelBtn');
        var openFunnel = document.getElementById('openFunnel');

        window.__openLeadModal = function(){
          if(window.CLICKFUNNEL_URL && String(window.CLICKFUNNEL_URL).trim() !== ''){
            window.open(window.CLICKFUNNEL_URL, '_blank', 'noopener');
            return;
          }
          if(overlay) overlay.style.display = 'block';
          if(modal) modal.style.display = 'flex';
          document.body.style.overflow = 'hidden';
          document.body.classList.add('modal-open');
        };

        window.__closeLeadModal = function(){
          if(overlay) overlay.style.display = 'none';
          if(modal) modal.style.display = 'none';
          document.body.style.overflow = '';
          document.body.classList.remove('modal-open');
        };

        if(openFunnel){
          openFunnel.addEventListener('click', function(e){
            e.preventDefault();
            window.__openLeadModal();
          });
          openFunnel.addEventListener('touchend', function(e){
            e.preventDefault();
            window.__openLeadModal();
          }, { passive:false });
        }

        if(closeBtn) closeBtn.addEventListener('click', window.__closeLeadModal);
        if(cancelBtn) cancelBtn.addEventListener('click', window.__closeLeadModal);
        if(overlay) overlay.addEventListener('click', window.__closeLeadModal);

        // ===== ESC KEY CLOSES MODALS =====
        document.addEventListener('keydown', function(e){
          if(e.key !== 'Escape') return;
          if(phcModal && phcModal.style.display === 'flex'){
            window.__closePHCModal();
            return;
          }
          if(modal && modal.style.display === 'flex'){
            window.__closeLeadModal();
          }
        });

        // Deep-link support
        if(location.hash === '#options') window.__openLeadModal();
      });
    })();
  </script>

  <script>
    // =====================
    // LEAD FORM STEP NAVIGATION & SUBMISSION
    // =====================
    (function(){
      function onReady(fn){
        if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', fn);
        else fn();
      }

      onReady(function(){
        var leadForm = document.getElementById('leadForm');
        if(!leadForm) return;

        var isMobile = window.matchMedia && window.matchMedia('(max-width: 600px)').matches;
        var currentStep = 0;
        var totalSteps = 4;
        
        var steps = document.querySelectorAll('.step');
        var stepperKicker = document.getElementById('stepperKicker');
        var stepperBarFill = document.getElementById('stepperBarFill');
        var dots = document.querySelectorAll('.dotx');
        var stepBack = document.getElementById('stepBack');
        var stepNext = document.getElementById('stepNext');
        var stepSubmit = document.getElementById('stepSubmit');
        var formStatus = document.getElementById('formStatus');
        var pdfResultsPanel = document.getElementById('pdfResultsPanel');

        // Initialize form submission state
        var formSubmitted = false;
        var formData = {};

        function showStep(index){
          currentStep = index;
          steps.forEach(function(s, i){
            s.classList.toggle('active', i === index);
          });
          dots.forEach(function(d, i){
            d.classList.toggle('active', i <= index);
          });
          if(stepperKicker) stepperKicker.textContent = 'Step ' + (index + 1) + ' of ' + totalSteps;
          if(stepperBarFill) stepperBarFill.style.width = ((index + 1) / totalSteps * 100) + '%';
          
          // Show/hide buttons based on step
          if(stepBack) stepBack.style.display = index === 0 ? 'none' : 'block';
          if(index === totalSteps - 1){
            if(stepNext) stepNext.style.display = 'none';
            if(stepSubmit) stepSubmit.style.display = 'block';
          } else {
            if(stepNext) stepNext.style.display = 'block';
            if(stepSubmit) stepSubmit.style.display = 'none';
          }
          
          updateNextButton();
        }

        function updateNextButton(){
          if(!isMobile || !stepNext) return;
          var currentStepEl = steps[currentStep];
          if(!currentStepEl) return;
          
          var requiredFields = currentStepEl.querySelectorAll('[required]');
          var allFilled = true;
          requiredFields.forEach(function(field){
            if(field.type === 'checkbox'){
              if(!field.checked) allFilled = false;
            } else {
              if(!field.value || field.value.trim() === '') allFilled = false;
            }
          });
          
          stepNext.disabled = !allFilled;
        }

        // Back button
        if(stepBack){
          stepBack.addEventListener('click', function(){
            if(currentStep > 0) showStep(currentStep - 1);
          });
        }

        // Next button
        if(stepNext){
          stepNext.addEventListener('click', function(){
            if(currentStep < totalSteps - 1) showStep(currentStep + 1);
          });
        }

        // Update Next button state on input
        if(isMobile){
          leadForm.addEventListener('input', updateNextButton);
          leadForm.addEventListener('change', updateNextButton);
        }

        // Form submission
        leadForm.addEventListener('submit', function(e){
          e.preventDefault();
          if(formSubmitted) return;
          
          // Collect form data
          var fd = new FormData(leadForm);
          formData = {};
          fd.forEach(function(value, key){
            formData[key] = value;
          });
          
          // Add PHC data if available
          if(window.PHC && window.PHC.result){
            formData.policyHealthScore = window.PHC.result.score;
            formData.policyHealthLabel = window.PHC.result.label;
            formData.policyHealthTriggers = window.PHC.result.triggers.join('; ');
            formData.policyHealthAnswers = JSON.stringify(window.PHC.answers);
          }
          
          // Add metadata
          formData.pageUrl = window.location.href;
          formData.userAgent = navigator.userAgent;
          formData.createdAt = new Date().toISOString();
          
          // Show loading state
          if(formStatus){
            formStatus.style.display = 'block';
            formStatus.className = 'status';
            formStatus.textContent = 'Submitting...';
          }
          
          // Submit to Google Apps Script
          var url = window.GAS_WEBAPP_URL;
          if(!url || url.trim() === ''){
            console.error('GAS_WEBAPP_URL not configured');
            showError('Configuration error. Please contact support.');
            return;
          }
          
          fetch(url, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
          })
          .then(function(){
            formSubmitted = true;
            if(formStatus){
              formStatus.className = 'status ok';
              formStatus.textContent = '✓ Submitted! An agent will follow up soon.';
            }
            
            // Show PDF results panel
            if(pdfResultsPanel){
              setTimeout(function(){
                pdfResultsPanel.classList.add('show');
              }, 500);
            }
            
            // Hide form steps and buttons
            if(isMobile){
              var stepsContainer = document.getElementById('steps');
              var stepper = document.getElementById('stepper');
              var rowMobile = document.getElementById('rowMobile');
              if(stepsContainer) stepsContainer.style.display = 'none';
              if(stepper) stepper.style.display = 'none';
              if(rowMobile) rowMobile.style.display = 'none';
            } else {
              var rowDesktop = document.getElementById('rowDesktop');
              if(rowDesktop) rowDesktop.style.display = 'none';
            }
          })
          .catch(function(err){
            console.error('Form submission error:', err);
            showError('Submission failed. Please try again.');
          });
        });

        function showError(msg){
          if(formStatus){
            formStatus.style.display = 'block';
            formStatus.className = 'status err';
            formStatus.textContent = msg;
          }
        }

        // Initialize
        if(isMobile){
          showStep(0);
        }
      });
    })();
  </script>

  <script>
    // =====================
    // PDF RESULTS GENERATION
    // =====================
    (function(){
      function onReady(fn){
        if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', fn);
        else fn();
      }

      onReady(function(){
        var downloadPdfBtn = document.getElementById('downloadPdfBtn');
        var pdfEmailGate = document.getElementById('pdfEmailGate');
        var pdfEmailInput = document.getElementById('pdfEmail');
        
        if(!downloadPdfBtn) return;

        downloadPdfBtn.addEventListener('click', function(){
          // Get email from form or prompt
          var emailField = document.getElementById('email');
          var email = emailField ? emailField.value : '';
          
          if(!email || email.trim() === ''){
            // Show email gate
            if(pdfEmailGate){
              pdfEmailGate.style.display = 'block';
              if(pdfEmailInput) pdfEmailInput.focus();
            }
            
            // Check if email is provided in gate
            if(pdfEmailInput && pdfEmailInput.value && pdfEmailInput.value.trim() !== ''){
              email = pdfEmailInput.value.trim();
            } else {
              return; // Wait for user to enter email
            }
          }
          
          // Build results object
          var leadForm = document.getElementById('leadForm');
          var leadData = {};
          if(leadForm){
            var fd = new FormData(leadForm);
            fd.forEach(function(value, key){
              leadData[key] = value;
            });
          }
          
          var phcData = null;
          if(window.PHC && window.PHC.result){
            phcData = {
              score: window.PHC.result.score,
              label: window.PHC.result.label,
              triggers: window.PHC.result.triggers,
              answers: window.PHC.answers
            };
          }
          
          var pdfPayload = {
            mode: 'pdf_results',
            email: email,
            leadData: leadData,
            phcData: phcData,
            pageUrl: window.location.href,
            userAgent: navigator.userAgent,
            createdAt: new Date().toISOString()
          };
          
          // Try backend PDF generation first
          var url = window.GAS_WEBAPP_URL;
          if(url && url.trim() !== ''){
            downloadPdfBtn.disabled = true;
            downloadPdfBtn.textContent = 'Generating...';
            
            fetch(url, {
              method: 'POST',
              mode: 'cors',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(pdfPayload)
            })
            .then(function(response){
              if(response.ok) return response.json();
              throw new Error('Backend PDF generation not available');
            })
            .then(function(data){
              if(data.pdfUrl){
                // Download from URL
                window.open(data.pdfUrl, '_blank');
                downloadPdfBtn.textContent = '✓ Downloaded';
              } else if(data.pdfBase64){
                // Download from base64
                var link = document.createElement('a');
                link.href = 'data:application/pdf;base64,' + data.pdfBase64;
                link.download = 'Policy-Options-Summary.pdf';
                link.click();
                downloadPdfBtn.textContent = '✓ Downloaded';
              } else {
                throw new Error('Invalid response');
              }
            })
            .catch(function(err){
              console.warn('Backend PDF generation failed, using client-side fallback:', err);
              generateClientSidePdf(pdfPayload);
            });
          } else {
            // No backend URL, use client-side immediately
            generateClientSidePdf(pdfPayload);
          }
        });
        
        function generateClientSidePdf(data){
          // Load jsPDF if not already loaded
          if(typeof window.jspdf === 'undefined'){
            var script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
            script.onload = function(){
              createPdf(data);
            };
            script.onerror = function(){
              alert('Failed to load PDF library. Please try again or contact support.');
              if(downloadPdfBtn){
                downloadPdfBtn.disabled = false;
                downloadPdfBtn.textContent = 'Download PDF';
              }
            };
            document.head.appendChild(script);
          } else {
            createPdf(data);
          }
        }
        
        function createPdf(data){
          try {
            var jsPDF = window.jspdf.jsPDF;
            var doc = new jsPDF();
            
            var y = 20;
            var lineHeight = 7;
            var pageWidth = doc.internal.pageSize.getWidth();
            var margin = 20;
            var maxWidth = pageWidth - 2 * margin;
            
            // Title
            doc.setFontSize(18);
            doc.setFont(undefined, 'bold');
            doc.text('Policy Options Summary', margin, y);
            y += lineHeight * 1.5;
            
            // Timestamp
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            doc.text('Generated: ' + new Date().toLocaleString(), margin, y);
            y += lineHeight * 1.5;
            
            // Lead form data
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.text('Contact Information', margin, y);
            y += lineHeight;
            
            doc.setFontSize(10);
            doc.setFont(undefined, 'normal');
            if(data.leadData){
              var fields = [
                { label: 'Name', key: ['firstName', 'lastName'] },
                { label: 'ZIP', key: 'zip' },
                { label: 'Email', key: 'email' },
                { label: 'Phone', key: 'phone' },
                { label: 'Home Status', key: 'homeowner' },
                { label: 'Vehicles', key: 'vehicles' },
                { label: 'Timeframe', key: 'timeframe' },
                { label: 'Roof Age', key: 'roofAge' },
                { label: 'Notes', key: 'notes' }
              ];
              
              fields.forEach(function(field){
                var value = '';
                if(Array.isArray(field.key)){
                  value = field.key.map(function(k){ return data.leadData[k] || ''; }).join(' ');
                } else {
                  value = data.leadData[field.key] || '';
                }
                
                if(value && value.trim() !== ''){
                  doc.text(field.label + ': ' + value, margin, y);
                  y += lineHeight;
                }
              });
            }
            
            y += lineHeight * 0.5;
            
            // Policy Health Check results
            if(data.phcData){
              doc.setFontSize(14);
              doc.setFont(undefined, 'bold');
              doc.text('Policy Health Check Results', margin, y);
              y += lineHeight;
              
              doc.setFontSize(10);
              doc.setFont(undefined, 'normal');
              doc.text('Score: ' + data.phcData.score, margin, y);
              y += lineHeight;
              doc.text('Status: ' + data.phcData.label, margin, y);
              y += lineHeight;
              
              if(data.phcData.triggers && data.phcData.triggers.length > 0){
                doc.text('Triggers:', margin, y);
                y += lineHeight;
                data.phcData.triggers.forEach(function(trigger){
                  var lines = doc.splitTextToSize('• ' + trigger, maxWidth - 10);
                  lines.forEach(function(line){
                    doc.text(line, margin + 5, y);
                    y += lineHeight;
                  });
                });
              }
              
              y += lineHeight * 0.5;
            }
            
            // Disclaimer
            y += lineHeight;
            doc.setFontSize(9);
            doc.setFont(undefined, 'italic');
            var disclaimerText = 'This is general information only. A licensed agent reviews all details before any quote, application, binding, or policy change.';
            var disclaimerLines = doc.splitTextToSize(disclaimerText, maxWidth);
            disclaimerLines.forEach(function(line){
              doc.text(line, margin, y);
              y += lineHeight * 0.8;
            });
            
            // Save PDF
            doc.save('Policy-Options-Summary.pdf');
            
            if(downloadPdfBtn){
              downloadPdfBtn.disabled = false;
              downloadPdfBtn.textContent = '✓ Downloaded';
            }
          } catch(err){
            console.error('PDF generation error:', err);
            alert('Failed to generate PDF. Please contact support.');
            if(downloadPdfBtn){
              downloadPdfBtn.disabled = false;
              downloadPdfBtn.textContent = 'Download PDF';
            }
          }
        }
      });
    })();
  </script>

  <script>
    /* ================== PHC + MODAL CONTROLLER CONSOLIDATED ================== */
    (function(){
      function onReady(fn){
        if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', fn);
        else fn();
      }

      onReady(function(){
        // Initialize PHC state
        window.PHC = {
          answers: {
            changes: [],
            property: '',
            deductible: '',
            liability: '',
            review: '',
            risks: []
          },
          result: null
        };

        var isMobile = window.matchMedia && window.matchMedia('(max-width: 600px)').matches;

        // ===== MOBILE FLOW SETUP =====
        if(isMobile){
          // Q0: Life changes (checkbox multi-select)
          var changesOpts = ['Moved', 'New vehicle', 'New drivers', 'Home upgrades', 'Business use', 'Claims', 'None'];
          var mobileChangesEl = document.getElementById('phcMobileChanges');
          if(mobileChangesEl){
            changesOpts.forEach(function(opt){
              var btn = document.createElement('button');
              btn.className = 'phc-answer-btn';
              btn.type = 'button';
              btn.textContent = opt;
              btn.dataset.value = opt;
              btn.addEventListener('click', function(){
                btn.classList.toggle('active');
                updateChangesAnswer();
              });
              mobileChangesEl.appendChild(btn);
            });
          }

          function updateChangesAnswer(){
            var selected = Array.from(mobileChangesEl.querySelectorAll('.phc-answer-btn.active')).map(function(b){ return b.dataset.value; });
            window.PHC.answers.changes = selected;
            // Q0 is always continuable (no required)
            document.getElementById('phcNext0').disabled = false;
          }

          // Q1: Property (single select, required)
          var propertyOpts = ['Primary home', 'Condo / Townhome', 'Landlord / Rental property', 'Renters policy', 'Not sure'];
          var mobilePropertyEl = document.getElementById('phcMobileProperty');
          if(mobilePropertyEl){
            propertyOpts.forEach(function(opt){
              var btn = document.createElement('button');
              btn.className = 'phc-answer-btn';
              btn.type = 'button';
              btn.textContent = opt;
              btn.dataset.value = opt;
              btn.addEventListener('click', function(){
                mobilePropertyEl.querySelectorAll('.phc-answer-btn').forEach(function(b){ b.classList.remove('active'); });
                btn.classList.add('active');
                window.PHC.answers.property = opt;
                document.getElementById('phcNext1').disabled = false;
              });
              mobilePropertyEl.appendChild(btn);
            });
          }
          document.getElementById('phcNext1').disabled = true;

          // Q2: Deductible (single select, required)
          var deductibleOpts = ['$500–$1,000', '$1,500–$2,500', '$2,500–$5,000+', 'Not sure'];
          var mobileDeductibleEl = document.getElementById('phcMobileDeductible');
          if(mobileDeductibleEl){
            deductibleOpts.forEach(function(opt){
              var btn = document.createElement('button');
              btn.className = 'phc-answer-btn';
              btn.type = 'button';
              btn.textContent = opt;
              btn.dataset.value = opt;
              btn.addEventListener('click', function(){
                mobileDeductibleEl.querySelectorAll('.phc-answer-btn').forEach(function(b){ b.classList.remove('active'); });
                btn.classList.add('active');
                window.PHC.answers.deductible = opt;
                document.getElementById('phcNext2').disabled = false;
              });
              mobileDeductibleEl.appendChild(btn);
            });
          }
          document.getElementById('phcNext2').disabled = true;

          // Q3: Liability (single select, required)
          var liabilityOpts = ['Very protected', 'Somewhat protected', 'Not protected', 'Not sure'];
          var mobileLiabilityEl = document.getElementById('phcMobileLiability');
          if(mobileLiabilityEl){
            liabilityOpts.forEach(function(opt){
              var btn = document.createElement('button');
              btn.className = 'phc-answer-btn';
              btn.type = 'button';
              btn.textContent = opt;
              btn.dataset.value = opt;
              btn.addEventListener('click', function(){
                mobileLiabilityEl.querySelectorAll('.phc-answer-btn').forEach(function(b){ b.classList.remove('active'); });
                btn.classList.add('active');
                window.PHC.answers.liability = opt;
                document.getElementById('phcNext3').disabled = false;
              });
              mobileLiabilityEl.appendChild(btn);
            });
          }
          document.getElementById('phcNext3').disabled = true;

          // Q4: Review (single select, required)
          var reviewOpts = ['Within 12 months', '1–3 years', '3+ years', 'Not sure'];
          var mobileReviewEl = document.getElementById('phcMobileReview');
          if(mobileReviewEl){
            reviewOpts.forEach(function(opt){
              var btn = document.createElement('button');
              btn.className = 'phc-answer-btn';
              btn.type = 'button';
              btn.textContent = opt;
              btn.dataset.value = opt;
              btn.addEventListener('click', function(){
                mobileReviewEl.querySelectorAll('.phc-answer-btn').forEach(function(b){ b.classList.remove('active'); });
                btn.classList.add('active');
                window.PHC.answers.review = opt;
                document.getElementById('phcNext4').disabled = false;
              });
              mobileReviewEl.appendChild(btn);
            });
          }
          document.getElementById('phcNext4').disabled = true;

          // Q5: Risks (checkbox multi-select, optional)
          var risksOpts = ['Wildfire exposure', 'Roof age 15+', 'Prior hail claims', 'Vacant / seasonal', 'Trampoline / pool', 'Dog liability', 'None'];
          var mobileRisksEl = document.getElementById('phcMobileRisks');
          if(mobileRisksEl){
            risksOpts.forEach(function(opt){
              var btn = document.createElement('button');
              btn.className = 'phc-answer-btn';
              btn.type = 'button';
              btn.textContent = opt;
              btn.dataset.value = opt;
              btn.addEventListener('click', function(){
                btn.classList.toggle('active');
                updateRisksAnswer();
              });
              mobileRisksEl.appendChild(btn);
            });
          }

          function updateRisksAnswer(){
            var selected = Array.from(mobileRisksEl.querySelectorAll('.phc-answer-btn.active')).map(function(b){ return b.dataset.value; });
            window.PHC.answers.risks = selected;
          }

          // Mobile navigation
          function showQuestion(qNum){
            for(var i = 0; i <= 5; i++){
              var q = document.getElementById('phcQ' + i);
              if(q) q.style.display = (i === qNum) ? 'block' : 'none';
            }
            var qDone = document.getElementById('phcQDone');
            if(qDone) qDone.style.display = 'none';
          }

          // Back buttons
          document.getElementById('phcBack1').addEventListener('click', function(){ showQuestion(0); });
          document.getElementById('phcBack2').addEventListener('click', function(){ showQuestion(1); });
          document.getElementById('phcBack3').addEventListener('click', function(){ showQuestion(2); });
          document.getElementById('phcBack4').addEventListener('click', function(){ showQuestion(3); });
          document.getElementById('phcBack5').addEventListener('click', function(){ showQuestion(4); });

          // Next/Continue buttons
          document.getElementById('phcNext0').addEventListener('click', function(){ showQuestion(1); });
          document.getElementById('phcNext1').addEventListener('click', function(){ showQuestion(2); });
          document.getElementById('phcNext2').addEventListener('click', function(){ showQuestion(3); });
          document.getElementById('phcNext3').addEventListener('click', function(){ showQuestion(4); });
          document.getElementById('phcNext4').addEventListener('click', function(){ showQuestion(5); });

          // Finish button
          document.getElementById('phcFinish').addEventListener('click', function(){
            computeResult();
            showMobileResult();
          });

          function showMobileResult(){
            for(var i = 0; i <= 5; i++){
              var q = document.getElementById('phcQ' + i);
              if(q) q.style.display = 'none';
            }
            var qDone = document.getElementById('phcQDone');
            if(qDone) qDone.style.display = 'block';

            var resultMobileEl = document.getElementById('phcResultMobile');
            if(resultMobileEl && window.PHC.result){
              var r = window.PHC.result;
              var html = '';
              html += '<div class="phc-result-top">';
              html += '<div class="phc-result-left">';
              html += '<span class="phc-dot ' + r.color + '"></span>';
              html += '<div><div class="phc-result-label">' + r.label + '</div></div>';
              html += '</div></div>';
              html += '<div class="phc-result-copy">' + r.copy + '</div>';
              if(r.subhead){
                html += '<div class="phc-subhead ' + r.color + '">' + r.subhead + '</div>';
              }
              if(r.triggers && r.triggers.length > 0){
                html += '<ul class="phc-result-why">';
                r.triggers.forEach(function(t){
                  html += '<li>' + t + '</li>';
                });
                html += '</ul>';
              }
              if(r.color === 'red'){
                html += '<div class="phc-loyalty show">';
                html += '<p class="m">Loyalty isn\'t the same as protection.</p>';
                html += '<button class="btn btn-primary" id="phcLeadCtaMobile" type="button">Check My Options</button>';
                html += '</div>';
              }
              html += '<div class="phc-result-actions">';
              html += '<button class="btn btn-primary phc-continue" id="phcCtaMobile" type="button">Continue to Options</button>';
              html += '</div>';
              resultMobileEl.innerHTML = html;

              // Wire up CTA buttons
              var phcLeadCtaMobile = document.getElementById('phcLeadCtaMobile');
              if(phcLeadCtaMobile){
                phcLeadCtaMobile.addEventListener('click', function(){
                  window.__closePHCModal();
                  setTimeout(function(){ window.__openLeadModal(); }, 100);
                });
              }
              var phcCtaMobile = document.getElementById('phcCtaMobile');
              if(phcCtaMobile){
                phcCtaMobile.addEventListener('click', function(){
                  window.__closePHCModal();
                  setTimeout(function(){ window.__openLeadModal(); }, 100);
                });
              }
            }
          }

          // Sync desktop if switched
          window.__PHC_SYNC_ON_OPEN = function(){
            showQuestion(0);
            // Clear mobile selections
            if(mobileChangesEl){
              mobileChangesEl.querySelectorAll('.phc-answer-btn').forEach(function(b){ b.classList.remove('active'); });
            }
            if(mobilePropertyEl){
              mobilePropertyEl.querySelectorAll('.phc-answer-btn').forEach(function(b){ b.classList.remove('active'); });
            }
            if(mobileDeductibleEl){
              mobileDeductibleEl.querySelectorAll('.phc-answer-btn').forEach(function(b){ b.classList.remove('active'); });
            }
            if(mobileLiabilityEl){
              mobileLiabilityEl.querySelectorAll('.phc-answer-btn').forEach(function(b){ b.classList.remove('active'); });
            }
            if(mobileReviewEl){
              mobileReviewEl.querySelectorAll('.phc-answer-btn').forEach(function(b){ b.classList.remove('active'); });
            }
            if(mobileRisksEl){
              mobileRisksEl.querySelectorAll('.phc-answer-btn').forEach(function(b){ b.classList.remove('active'); });
            }
            // Reset state
            window.PHC.answers = { changes:[], property:'', deductible:'', liability:'', review:'', risks:[] };
            document.getElementById('phcNext1').disabled = true;
            document.getElementById('phcNext2').disabled = true;
            document.getElementById('phcNext3').disabled = true;
            document.getElementById('phcNext4').disabled = true;
          };
        }

        // ===== DESKTOP FLOW SETUP =====
        if(!isMobile){
          var phcChangesEl = document.getElementById('phcChanges');
          var phcPropertyEl = document.getElementById('phcProperty');
          var phcDeductibleEl = document.getElementById('phcDeductible');
          var phcLiabilityEl = document.getElementById('phcLiability');
          var phcReviewEl = document.getElementById('phcReview');
          var phcRisksEl = document.getElementById('phcRisks');

          // Desktop Finish button
          var phcFinishDesktop = document.getElementById('phcFinishDesktop');
          if(phcFinishDesktop){
            phcFinishDesktop.addEventListener('click', function(){
              // Collect answers from desktop grid
              var changesChecked = [];
              if(phcChangesEl){
                phcChangesEl.querySelectorAll('input[type="checkbox"]:checked').forEach(function(cb){
                  changesChecked.push(cb.value);
                });
              }
              window.PHC.answers.changes = changesChecked;
              window.PHC.answers.property = phcPropertyEl ? phcPropertyEl.value : '';
              window.PHC.answers.deductible = phcDeductibleEl ? phcDeductibleEl.value : '';
              window.PHC.answers.liability = phcLiabilityEl ? phcLiabilityEl.value : '';
              window.PHC.answers.review = phcReviewEl ? phcReviewEl.value : '';
              var risksChecked = [];
              if(phcRisksEl){
                phcRisksEl.querySelectorAll('input[type="checkbox"]:checked').forEach(function(cb){
                  risksChecked.push(cb.value);
                });
              }
              window.PHC.answers.risks = risksChecked;

              // Check required fields
              if(!window.PHC.answers.property || !window.PHC.answers.deductible || !window.PHC.answers.liability || !window.PHC.answers.review){
                alert('Please fill in all required fields (*).');
                return;
              }

              computeResult();
              showDesktopResult();
            });
          }

          function showDesktopResult(){
            var phcResult = document.getElementById('phcResult');
            if(phcResult && window.PHC.result){
              var r = window.PHC.result;
              phcResult.classList.add('show');

              var phcDot = document.getElementById('phcDot');
              if(phcDot){
                phcDot.className = 'phc-dot ' + r.color;
              }

              var phcLabel = document.getElementById('phcLabel');
              if(phcLabel){
                phcLabel.textContent = r.label;
              }

              var phcCopy = document.getElementById('phcCopy');
              if(phcCopy){
                phcCopy.textContent = r.copy;
              }

              var phcSubhead = document.getElementById('phcSubhead');
              if(phcSubhead){
                phcSubhead.textContent = r.subhead || '';
                phcSubhead.className = 'phc-subhead ' + r.color;
              }

              var phcWhy = document.getElementById('phcWhy');
              if(phcWhy){
                phcWhy.innerHTML = '';
                if(r.triggers && r.triggers.length > 0){
                  r.triggers.forEach(function(t){
                    var li = document.createElement('li');
                    li.textContent = t;
                    phcWhy.appendChild(li);
                  });
                }
              }

              var phcLoyalty = document.getElementById('phcLoyalty');
              if(phcLoyalty){
                if(r.color === 'red'){
                  phcLoyalty.classList.add('show');
                } else {
                  phcLoyalty.classList.remove('show');
                }
              }
            }
          }

          // Desktop Reset button
          var phcReset = document.getElementById('phcReset');
          if(phcReset){
            phcReset.addEventListener('click', function(){
              if(phcChangesEl) phcChangesEl.querySelectorAll('input[type="checkbox"]').forEach(function(cb){ cb.checked = false; });
              if(phcPropertyEl) phcPropertyEl.value = '';
              if(phcDeductibleEl) phcDeductibleEl.value = '';
              if(phcLiabilityEl) phcLiabilityEl.value = '';
              if(phcReviewEl) phcReviewEl.value = '';
              if(phcRisksEl) phcRisksEl.querySelectorAll('input[type="checkbox"]').forEach(function(cb){ cb.checked = false; });
              window.PHC.answers = { changes:[], property:'', deductible:'', liability:'', review:'', risks:[] };
              var phcResult = document.getElementById('phcResult');
              if(phcResult) phcResult.classList.remove('show');
            });
          }

          // Desktop CTA buttons (already in DOM)
          var phcLeadCta = document.getElementById('phcLeadCta');
          if(phcLeadCta){
            phcLeadCta.addEventListener('click', function(){
              window.__closePHCModal();
              setTimeout(function(){ window.__openLeadModal(); }, 100);
            });
          }

          var phcCta = document.getElementById('phcCta');
          if(phcCta){
            phcCta.addEventListener('click', function(){
              window.__closePHCModal();
              setTimeout(function(){ window.__openLeadModal(); }, 100);
            });
          }
        }

        // ===== RESULT COMPUTATION (Green <3, Yellow 3-5, Red >=6) =====
        function computeResult(){
          var score = 0;
          var triggers = [];
          var ans = window.PHC.answers;

          // Scoring logic
          // 1) Life changes: each non-None adds +1
          if(ans.changes && ans.changes.length > 0){
            var nonNoneChanges = ans.changes.filter(function(c){ return c !== 'None'; });
            if(nonNoneChanges.length > 0){
              score += nonNoneChanges.length;
              triggers.push('Recent life changes (' + nonNoneChanges.join(', ') + ')');
            }
          }

          // 2) Property: certain answers add +1
          if(ans.property && (ans.property.indexOf('Landlord') !== -1 || ans.property === 'Not sure')){
            score += 1;
            triggers.push('Property situation: ' + ans.property);
          }

          // 3) Deductible: "Not sure" adds +1
          if(ans.deductible === 'Not sure'){
            score += 1;
            triggers.push('Unsure about deductible comfort level');
          }

          // 4) Liability: "Not protected" or "Not sure" adds +1
          if(ans.liability === 'Not protected' || ans.liability === 'Not sure'){
            score += 1;
            triggers.push('Liability coverage concern: ' + ans.liability);
          }

          // 5) Review: 1-3 years = +1, 3+ years or Not sure = +2
          if(ans.review === '1–3 years'){
            score += 1;
            triggers.push('Last review 1–3 years ago');
          } else if(ans.review === '3+ years' || ans.review === 'Not sure'){
            score += 2;
            triggers.push('Last review 3+ years ago or unsure');
          }

          // 6) Risks: each non-None adds +1
          if(ans.risks && ans.risks.length > 0){
            var nonNoneRisks = ans.risks.filter(function(r){ return r !== 'None'; });
            if(nonNoneRisks.length > 0){
              score += nonNoneRisks.length;
              triggers.push('Property risk flags: ' + nonNoneRisks.join(', '));
            }
          }

          // Determine color and label
          var color, label, copy, subhead;
          if(score < 3){
            color = 'green';
            label = 'Green';
            copy = 'Your coverage likely matches your current situation.';
            subhead = 'Most people don\'t switch because they\'re happy — they stay because nothing triggered a review. We help you check if your coverage still makes sense today.';
          } else if(score >= 3 && score <= 5){
            color = 'yellow';
            label = 'Yellow';
            copy = 'Some changes suggest a review could help optimize your coverage.';
            subhead = 'Most people don\'t switch because they\'re happy — they stay because nothing triggered a review. We help you check if your coverage still makes sense today.';
          } else {
            color = 'red';
            label = 'Red';
            copy = 'Multiple flags suggest your coverage may have gaps.';
            subhead = 'Most people don\'t switch because they\'re happy — they stay because nothing triggered a review. We help you check if your coverage still makes sense today.';
          }

          window.PHC.result = {
            score: score,
            color: color,
            label: label,
            copy: copy,
            subhead: subhead,
            triggers: triggers
          };

          // Populate hidden inputs in lead form
          populateLeadFormInputs();
        }

        function populateLeadFormInputs(){
          var leadForm = document.getElementById('leadForm');
          if(!leadForm) return;

          var r = window.PHC.result;
          if(!r) return;

          // Remove existing hidden inputs
          leadForm.querySelectorAll('input[name^="policyHealth"]').forEach(function(inp){ inp.remove(); });

          // Create new hidden inputs
          function addHidden(name, value){
            var inp = document.createElement('input');
            inp.type = 'hidden';
            inp.name = name;
            inp.value = value;
            leadForm.appendChild(inp);
          }

          addHidden('policyHealthAnswers', JSON.stringify(window.PHC.answers));
          addHidden('policyHealthScore', String(r.score));
          addHidden('policyHealthLabel', r.label);
          addHidden('policyHealthTriggers', r.triggers.join('; '));
          addHidden('policyHealthCtaText', 'Check My Options');
        }
      });
    })();
  </script>

  <script>
    // =====================
    // DISCLAIMER MODAL
    // =====================
    (function(){
      function onReady(fn){
        if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', fn);
        else fn();
      }
      onReady(function(){
        var openBtn = document.getElementById('openDisclaimer');
        var overlay = document.getElementById('discOverlay');
        var modal = document.getElementById('discModal');
        var close1 = document.getElementById('discClose');
        var close2 = document.getElementById('discClose2');
        var accept = document.getElementById('discAccept');

        function open(){
          if(overlay) overlay.style.display = 'block';
          if(modal) modal.style.display = 'flex';
          document.body.classList.add('modal-open');
        }
        function close(){
          if(overlay) overlay.style.display = 'none';
          if(modal) modal.style.display = 'none';
          document.body.classList.remove('modal-open');
        }

        if(openBtn){
          openBtn.addEventListener('click', open);
          openBtn.addEventListener('touchend', function(e){ e.preventDefault(); open(); }, { passive:false });
        }
        if(overlay) overlay.addEventListener('click', close);
        if(close1) close1.addEventListener('click', close);
        if(close2) close2.addEventListener('click', close);
        if(accept) accept.addEventListener('click', close);

        document.addEventListener('keydown', function(e){ if(e.key === 'Escape') close(); });
      });
    })();
  </script>

  <script>
    // =====================
    // HERO ROTATOR (simple crossfade)
    // =====================
    (function(){
      function onReady(fn){
        if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', fn);
        else fn();
      }
      onReady(function(){
        var imgs = [document.getElementById('heroImg0'), document.getElementById('heroImg1'), document.getElementById('heroImg2')].filter(Boolean);
        var header = document.getElementById('heroHeader');
        if(imgs.length < 2) return;
        var headers = ['Home Insurance', 'Car Insurance', 'Business Insurance'];
        var idx = 0;

        function show(i){
          imgs.forEach(function(im, k){
            if(!im) return;
            im.classList.toggle('active', k === i);
          });
          if(header) header.textContent = headers[i] || headers[0];
        }

        show(0);
        setInterval(function(){
          idx = (idx + 1) % imgs.length;
          show(idx);
        }, 6000);
      });
    })();
  </script>

  <script>
    // =====================
    // POLICYPRO CHAT WIDGET (FIXED)
    // =====================
    (function(){
      function onReady(fn){
        if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', fn);
        else fn();
      }

      onReady(function(){
        var launcher = document.getElementById('chatBtn');
        var chatWindow = document.getElementById('chatWindow');
        var closeBtn = document.getElementById('closeChat');

        if(!launcher || !chatWindow) return;

        function isOpen(){
          return chatWindow.style.display === 'block';
        }

        function openChat(){
          chatWindow.style.display = 'block';
          launcher.style.display = 'none';
          launcher.setAttribute('aria-expanded', 'true');
        }

        function closeChat(){
          chatWindow.style.display = 'none';
          launcher.style.display = 'flex';
          launcher.setAttribute('aria-expanded', 'false');
        }

        // Chat launcher - click handler (works on both desktop and mobile)
        launcher.addEventListener('click', function(e){
          e.preventDefault();
          e.stopPropagation();
          isOpen() ? closeChat() : openChat();
        });

        // Close button
        if(closeBtn){
          closeBtn.addEventListener('click', function(e){
            e.preventDefault();
            e.stopPropagation();
            closeChat();
          });
        }

        // ESC key closes chat
        document.addEventListener('keydown', function(e){
          if(e.key === 'Escape' && isOpen()){
            closeChat();
          }
        });
      });
    })();
  </script>

  <script>
    (function () {
      const toggle = document.getElementById("agentToggle");
      const panel = document.getElementById("agentInfoPanel");
      const bar = document.querySelector(".agent-bar");
      const langBtn = document.getElementById("topLangBtn");
      const langMenu = document.getElementById("langMenu");
      const langPill = document.getElementById("langPill");
      if (!bar) return;

      function syncBarHeight(){
        document.documentElement.style.setProperty("--agent-bar-h", Math.round(bar.getBoundingClientRect().height) + "px");
      }

      // Agent panel toggle
      if (toggle && panel){
        function openAgent(){
          toggle.setAttribute("aria-expanded","true");
          panel.hidden = false;
          panel.setAttribute("aria-hidden","false");
          syncBarHeight();
        }
        function closeAgent(){
          toggle.setAttribute("aria-expanded","false");
          panel.hidden = true;
          panel.setAttribute("aria-hidden","true");
        }
        toggle.addEventListener("click", (e)=>{
          e.stopPropagation();
          toggle.getAttribute("aria-expanded")==="true" ? closeAgent() : openAgent();
        });
        document.addEventListener("click", (e)=>{
          if (panel.hidden) return;
          if (panel.contains(e.target) || bar.contains(e.target)) return;
          closeAgent();
        });
        document.addEventListener("keydown",(e)=>{ if (e.key==="Escape") closeAgent(); });
      }

      // Language dropdown
      const LANGS = {
        en: { pill:"EN", label:"English" },
        es: { pill:"ES", label:"Spanish" },
        vi: { pill:"VI", label:"Vietnamese" },
        zh: { pill:"中文", label:"Chinese" }
      };

      function setLangUI(code){
        const cfg = LANGS[code] || LANGS.en;
        if (langPill) langPill.textContent = cfg.pill;
        if (langBtn) langBtn.setAttribute("aria-label", "Language: " + cfg.label);
        if (langMenu){
          langMenu.querySelectorAll(".lang-option").forEach(btn=>{
            const is = btn.getAttribute("data-lang") === code;
            btn.setAttribute("aria-checked", is ? "true" : "false");
            const check = btn.querySelector(".check");
            if (check) check.style.opacity = is ? "1" : "0";
          });
        }
      }

      function openLangMenu(){
        if (!langBtn || !langMenu) return;
        const r = langBtn.getBoundingClientRect();
        const menuW = 240;
        const left = Math.min(Math.max(10, r.right - menuW), window.innerWidth - menuW - 10);
        const top = Math.min(r.bottom + 10, window.innerHeight - 20);
        langMenu.style.width = menuW + "px";
        langMenu.style.left = left + "px";
        langMenu.style.top = top + "px";
        langMenu.hidden = false;
        langBtn.setAttribute("aria-expanded","true");
      }

      function closeLangMenu(){
        if (!langBtn || !langMenu) return;
        langMenu.hidden = true;
        langBtn.setAttribute("aria-expanded","false");
      }

      if (langBtn && langMenu){
        langBtn.addEventListener("click", (e)=>{
          e.stopPropagation();
          langMenu.hidden ? openLangMenu() : closeLangMenu();
        });

        langMenu.addEventListener("click", (e)=>{
          const btn = e.target.closest(".lang-option");
          if (!btn) return;
          const code = btn.getAttribute("data-lang") || "en";
          localStorage.setItem("sci_lang", code);
          setLangUI(code);
          closeLangMenu();
          if (typeof window.setLanguage === "function") window.setLanguage(code);
        });

        document.addEventListener("click", (e)=>{
          if (langMenu.hidden) return;
          if (langMenu.contains(e.target) || langBtn.contains(e.target)) return;
          closeLangMenu();
        });

        document.addEventListener("keydown",(e)=>{ if (e.key==="Escape") closeLangMenu(); });

        const saved = localStorage.getItem("sci_lang") || "en";
        setLangUI(saved);
      }

      syncBarHeight();
      window.addEventListener("resize", syncBarHeight, { passive:true });
    })();
  </script>

  <script>
    (function(){
      const testimonials = [
        { quote:"The Policy Health Check took under a minute and showed we were under-insured on liability. No pressure, just clear next steps.", name:"Emily R., Fort Collins, CO" },
        { quote:"I didn’t realize our deductible no longer made sense. The tool explained it in plain English.", name:"Jason M., Colorado Springs, CO" },
        { quote:"We used the Health Check after a remodel and caught a coverage gap I would’ve missed.", name:"Sarah L., Littleton, CO" },
        { quote:"Quick, straightforward, and not salesy at all.", name:"Mark D., Loveland, CO" },
        { quote:"It simply showed what changed since we started our policy years ago.", name:"Nicole K., Castle Rock, CO" }
      ];
      let i = 0;
      const q = document.getElementById("trustQuote");
      const n = document.getElementById("trustName");
      if(!q || !n) return;
      setInterval(()=>{
        i = (i + 1) % testimonials.length;
        q.style.opacity = 0;
        n.style.opacity = 0;
        setTimeout(()=>{
          q.textContent = "“" + testimonials[i].quote + "”";
          n.textContent = "— " + testimonials[i].name;
          q.style.opacity = 1;
          n.style.opacity = 1;
        },300);
      },3000);
    })();
  </script>

</body>
</html>
